<!DOCTYPE html>
<html lang="zh-CN,en,zh-TW,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.leehengtong.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="咖啡时间">
<meta property="og:url" content="https://www.leehengtong.com/index.html">
<meta property="og:site_name" content="咖啡时间">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="李亨通@leehengtong">
<meta property="article:tag" content="无人驾驶; self-driving; 机器学习; machine learning; 金融; finance; 技术; techonlogy;">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.leehengtong.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>咖啡时间</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G5NJ0PJQP1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-G5NJ0PJQP1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b48103569e609595468166fd26864197";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<script src="/assets/js/DPlayer.min.js"></script></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">咖啡时间</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Learn, Discuss and Share</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-leetcode">

    <a href="/categories/leetcode/" rel="section"><i class="fa fa-calendar fa-fw"></i>leetcode</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/02/14/interval_dynamic_program/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/14/interval_dynamic_program/" class="post-title-link" itemprop="url">区间动态规划</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-14 23:00:34" itemprop="dateCreated datePublished" datetime="2021-02-14T23:00:34+08:00">2021-02-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-16 19:48:47" itemprop="dateModified" datetime="2021-02-16T19:48:47+08:00">2021-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>区间动态规划是很重要的一种动态规划类别，对于这种问题，要仔细分析理解题意，建立从小区间构造大区间的方法。下面我们以几个leetcode上面的题目为例给出分析思路和解析。在所有这些题目中，有一点往往是一样的：我们一般都是对最终的结果建立dp数组，也就是dp中的单个元素往往表示的是给定区间内的最优解，这一点在思考dp问题的时候尤为重要。</p>
<h3 id="leetcode-312：-Burst-Balloons"><a href="#leetcode-312：-Burst-Balloons" class="headerlink" title="leetcode 312： Burst Balloons"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/burst-balloons/">leetcode 312： Burst Balloons</a></h3><blockquote>
<p>You are given n balloons, indexed from 0 to n - 1. Each balloon is painted with a number on it represented by an array nums. You are asked to burst all the balloons.</p>
<p>If you burst the ith balloon, you will get nums[i - 1] * nums[i] * nums[i + 1] coins. If i - 1 or i + 1 goes out of bounds of the array, then treat it as if there is a balloon with a 1 painted on it.</p>
<p>Return the maximum coins you can collect by bursting the balloons wisely.</p>
<p>Example 1:</p>
<p>Input: nums = [3,1,5,8]<br>Output: 167<br>Explanation:<br>nums = [3,1,5,8] –&gt; [3,5,8] –&gt; [3,8] –&gt; [8] –&gt; []<br>coins =  3<em>1</em>5    +   3<em>5</em>8   +  1<em>3</em>8  + 1<em>8</em>1 = 167</p>
<p>Example 2:<br>Input: nums = [1,5]<br>Output: 10</p>
<p>Constraints:<br>n == nums.length<br>1 &lt;= n &lt;= 500<br>0 &lt;= nums[i] &lt;= 100</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxCoins</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">data</span><span class="params">(nums.size(), <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(nums.size(), <span class="number">0</span>))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= nums.size(); ++len) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + len - <span class="number">1</span> &lt; nums.size(); ++i) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = i + len - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (len == <span class="number">1</span>) &#123;</span><br><span class="line">                    data[i][i] = value(nums, i);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= j; ++k) &#123;</span><br><span class="line">                    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">int</span> right = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span> (k &gt; i) &#123;</span><br><span class="line">                        left = data[i][k<span class="number">-1</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (k &lt; j) &#123;</span><br><span class="line">                        right = data[k+<span class="number">1</span>][j];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">int</span> mid = nums[k];</span><br><span class="line">                    <span class="keyword">if</span> (i - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                        mid = mid * nums[i<span class="number">-1</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (j + <span class="number">1</span> &lt; nums.size()) &#123;</span><br><span class="line">                        mid = mid * nums[j + <span class="number">1</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">int</span> cur = left + mid + right;</span><br><span class="line">                    data[i][j] = max(cur, data[i][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> data.front().back();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = nums[pos];</span><br><span class="line">        <span class="keyword">if</span> (pos - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            res = res * nums[pos - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pos + <span class="number">1</span> &lt; nums.size()) &#123;</span><br><span class="line">            res = res * nums[pos + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在这个题目中，我们使用data[i][j]表示在区间[i, j]所能获得的最大值。在捅破[i, j]区间的气球时候，我们先选择一个气球k最后捅破（当前最先捅破也可以，只不过处理方法不一样），然后这样就把一个大区间的问题分解成了两个小区间[i, k-1], [k+1, j]的问题。这里请注意，当捅破第k个气球的时候，它的邻居已经和原来不一样了。</p>
<h3 id="leetcode-1547-Minimum-Cost-to-Cut-a-Stick"><a href="#leetcode-1547-Minimum-Cost-to-Cut-a-Stick" class="headerlink" title="leetcode 1547: Minimum Cost to Cut a Stick"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/minimum-cost-to-cut-a-stick/">leetcode 1547: Minimum Cost to Cut a Stick</a></h3><blockquote>
<p>Given a wooden stick of length n units. The stick is labelled from 0 to n. For example, a stick of length 6 is labelled as follows:</p>
<p>Given an integer array cuts where cuts[i] denotes a position you should perform a cut at.</p>
<p>You should perform the cuts in order, you can change the order of the cuts as you wish.</p>
<p>The cost of one cut is the length of the stick to be cut, the total cost is the sum of costs of all cuts. When you cut a stick, it will be split into two smaller sticks (i.e. the sum of their lengths is the &gt; length of the stick before the cut). Please refer to the first example for a better explanation.</p>
<p>Return the minimum total cost of the cuts.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCost</span><span class="params">(<span class="keyword">int</span> n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; cuts)</span> </span>&#123;</span><br><span class="line">        cuts.push_back(<span class="number">0</span>);</span><br><span class="line">        cuts.push_back(n);</span><br><span class="line">        sort(cuts.begin(), cuts.end());</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">data</span><span class="params">(cuts.size(), <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(cuts.size(), <span class="number">-1</span>))</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cut_num = <span class="number">2</span>; cut_num &lt;= cuts.size(); ++cut_num) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> start_cut_idx = <span class="number">0</span>; start_cut_idx + cut_num - <span class="number">1</span> &lt; cuts.size(); ++start_cut_idx) &#123;</span><br><span class="line">                <span class="keyword">int</span> end_cut_idx = start_cut_idx + cut_num - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (cut_num == <span class="number">2</span>) &#123;</span><br><span class="line">                    data[start_cut_idx][end_cut_idx] = <span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> len = cuts[end_cut_idx] - cuts[start_cut_idx];</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> cur_cut_idx = start_cut_idx + <span class="number">1</span>; cur_cut_idx &lt; end_cut_idx; ++cur_cut_idx) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (data[start_cut_idx][end_cut_idx] == <span class="number">-1</span>) &#123;</span><br><span class="line">                            data[start_cut_idx][end_cut_idx] = data[start_cut_idx][cur_cut_idx] + len + data[cur_cut_idx][end_cut_idx];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            data[start_cut_idx][end_cut_idx] = min(data[start_cut_idx][end_cut_idx], data[start_cut_idx][cur_cut_idx] + len + data[cur_cut_idx][end_cut_idx]);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> data[<span class="number">0</span>].back();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>对于这个题目，我们使用data[start_cut_idx][end_cut_idx]表示从第start_cut_idx个砍断位置到第end_cut_idx个砍断位置的最小cost. 和前面比较类似，在处理区间[start_cut_idx, end_cut_idx]的时候，我们也是不断尝试改变下刀位置，从而将大区间的问题分解成两个小区间的问题； 不过这里有一点需要注意，我们把0和n也当做一个砍断位置来处理，这样比较简单。</p>
<h3 id="leetcode-1000-Minimum-Cost-to-Merge-Stones"><a href="#leetcode-1000-Minimum-Cost-to-Merge-Stones" class="headerlink" title="leetcode 1000: Minimum Cost to Merge Stones"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/minimum-cost-to-merge-stones/">leetcode 1000: Minimum Cost to Merge Stones</a></h3><blockquote>
<p>There are N piles of stones arranged in a row.  The i-th pile has stones[i] stones.</p>
<p>A move consists of merging exactly K consecutive piles into one pile, and the cost of this move is equal to the total number of stones in these K piles.</p>
<p>Find the minimum cost to merge all piles of stones into one pile.  If it is impossible, return -1.</p>
<p>Example 1:<br>Input: stones = [3,2,4,1], K = 2<br>Output: 20<br>Explanation:<br>We start with [3, 2, 4, 1].<br>We merge [3, 2] for a cost of 5, and we are left with [5, 4, 1].<br>We merge [4, 1] for a cost of 5, and we are left with [5, 5].<br>We merge [5, 5] for a cost of 10, and we are left with [10].<br>The total cost was 20, and this is the minimum possible.</p>
<p>Example 2:<br>Input: stones = [3,2,4,1], K = 3<br>Output: -1<br>Explanation: After any merge operation, there are 2 piles left, and we can’t merge anymore.  So the task is impossible.</p>
<p>Example 3:<br>Input: stones = [3,5,1,2,6], K = 3<br>Output: 25<br>Explanation:<br>We start with [3, 5, 1, 2, 6].<br>We merge [5, 1, 2] for a cost of 8, and we are left with [3, 8, 6].<br>We merge [3, 8, 6] for a cost of 17, and we are left with [17].<br>The total cost was 25, and this is the minimum possible.</p>
<p>Note:<br>1 &lt;= stones.length &lt;= 30<br>2 &lt;= K &lt;= 30<br>1 &lt;= stones[i] &lt;= 100</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">mergeStones</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; stones, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> n = stones.size();</span><br><span class="line">        <span class="keyword">if</span> ((n - K) % (K - <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">// calculate the sum from 0 to i        </span></span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">sumStones</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            sumStones[i + <span class="number">1</span>] = sumStones[i] + stones[i]; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// initialize the 3d vector dp</span></span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&gt; <span class="title">dp</span><span class="params">(n, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;(n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(K + <span class="number">1</span>, <span class="number">1e9</span>)))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            dp[i][i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// compute the transition functions</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> stepLen = <span class="number">2</span>; stepLen &lt;= n; ++stepLen) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt;= n - stepLen; ++i) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = i + stepLen - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> k = <span class="number">2</span>; k &lt;= K; k++) &#123;</span><br><span class="line">                    <span class="keyword">for</span> ( <span class="keyword">auto</span> m = i; m &lt; j; m += K - <span class="number">1</span>) &#123;</span><br><span class="line">                        dp[i][j][k] = min(dp[i][j][k], dp[i][m][<span class="number">1</span>] + dp[m + <span class="number">1</span>][j][k - <span class="number">1</span>]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][j][<span class="number">1</span>] = dp[i][j][K] + sumStones[j + <span class="number">1</span>] - sumStones[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][n - <span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这道题首先让人想到哈夫曼编码，但是请注意”merging exactly K consecutive piles into one pile”，所以这个题目并不是一个哈夫曼编码的题目。<br>这这道题中，我们使用三维状态dp[i][j][k]表示把从[i, j]的石头合并成k堆的最小代价。在22-24行里面，我们尝试进行多次merge是的最终的个数是k。因为对于每一个区间我们都尝试进行多次merge，所以dp[i][j][k]表示的是把[i,j]中的石头通过各种方法merge成k的最小cost.</p>
<h3 id="leetcode-813-Largest-Sum-of-Averages"><a href="#leetcode-813-Largest-Sum-of-Averages" class="headerlink" title="leetcode 813: Largest Sum of Averages"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/largest-sum-of-averages/">leetcode 813: Largest Sum of Averages</a></h3><blockquote>
<p>We partition a row of numbers A into at most K adjacent (non-empty) groups, then our score is the sum of the average of each group. What is the largest score we can achieve?</p>
<p>Note that our partition must use every number in A, and that scores are not necessarily integers.</p>
<p>Example:<br>Input:<br>A = [9,1,2,3,9]<br>K = 3<br>Output: 20<br>Explanation:<br>The best choice is to partition A into [9], [1, 2, 3], [9]. The answer is 9 + (1 + 2 + 3) / 3 + 9 = 20.<br>We could have also partitioned A into [9, 1], [2], [3, 9], for example.<br>That partition would lead to a score of 5 + 2 + 6 = 13, which is worse.</p>
<p>Note:</p>
<p>1 &lt;= A.length &lt;= 100.<br>1 &lt;= A[i] &lt;= 10000.<br>1 &lt;= K &lt;= A.length.<br>Answers within $10^{-6}$ of the correct answer will be accepted as correct.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">largestSumOfAverages</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt;&gt; <span class="title">data</span><span class="params">(A.size(), <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt;(k + <span class="number">1</span>, <span class="number">-1</span>))</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">sum</span><span class="params">(A)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; A.size(); ++i) &#123;</span><br><span class="line">            sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j == <span class="number">1</span>) &#123;</span><br><span class="line">                    data[i][j] = sum[i] * <span class="number">1.0</span> / (i + <span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt; i; ++t) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (data[t][j<span class="number">-1</span>] != <span class="number">-1</span>) &#123;</span><br><span class="line">                            data[i][j] = max(data[i][j], data[t][j<span class="number">-1</span>] + (sum[i] - sum[t]) * <span class="number">1.0</span> / (i - t));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> data.back().back();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>和前面的几个问题不同，在这个题目中，我们操作的区间的起点是固定的，这也是一种常见的dp方式。我们使用data[i][j]表示把[0, i]中的数字分成j组所获得的最大值。在第18行迭代的过程中，我们先把前t个元素分成j-1组，然后再把[t+1, i]的元素分到第j组。</p>
<h3 id="leetcode-87-Scramble-String"><a href="#leetcode-87-Scramble-String" class="headerlink" title="leetcode 87: Scramble String"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/scramble-string/">leetcode 87: Scramble String</a></h3><blockquote>
<p>We can scramble a string s to get a string t using the following algorithm:</p>
<p>If the length of the string is 1, stop.<br>If the length of the string is &gt; 1, do the following:<br>Split the string into two non-empty substrings at a random index, i.e., if the string is s, divide it to x and y where s = x + y.<br>Randomly decide to swap the two substrings or to keep them in the same order. i.e., after this step, s may become s = x + y or s = y + x.<br>Apply step 1 recursively on each of the two substrings x and y.<br>Given two strings s1 and s2 of the same length, return true if s2 is a scrambled string of s1, otherwise, return false.</p>
<p>Example 1:<br>Input: s1 = “great”, s2 = “rgeat”<br>Output: true<br>Explanation: One possible scenario applied on s1 is:<br>“great” –&gt; “gr/eat” // divide at random index.<br>“gr/eat” –&gt; “gr/eat” // random decision is not to swap the two substrings and keep them in order.<br>“gr/eat” –&gt; “g/r / e/at” // apply the same algorithm recursively on both substrings. divide at ranom index each of them.<br>“g/r / e/at” –&gt; “r/g / e/at” // random decision was to swap the first substring and to keep the second substring in the same order.<br>“r/g / e/at” –&gt; “r/g / e/ a/t” // again apply the algorithm recursively, divide “at” to “a/t”.<br>“r/g / e/ a/t” –&gt; “r/g / e/ a/t” // random decision is to keep both substrings in the same order.<br>The algorithm stops now and the result string is “rgeat” which is s2.<br>As there is one possible scenario that led s1 to be scrambled to s2, we return true.</p>
<p>Example 2:<br>Input: s1 = “abcde”, s2 = “caebd”<br>Output: false</p>
<p>Example 3:<br>Input: s1 = “a”, s2 = “a”<br>Output: true</p>
<p>Constraints:<br>s1.length == s2.length<br>1 &lt;= s1.length &lt;= 30<br>s1 and s2 consist of lower-case English letters.</p>
</blockquote>
<p>这个题目比较好理解，我们把s1的前k个元素构成的子串叫做l1, 后k个叫做r1; 对于s2来说，l2和r2同理。所以一共有三种匹配的情况：（1）l1和l2匹配，头头匹配；（2）l1和r2匹配，头尾匹配；（3）r1和l2匹配，尾头匹配。因为我们会先确保s1和s2由相同的元素构成，所以在上面这三种情况下，两个字符串余下的部分自然是可以匹配的。基于这个思想，我们先给出递归算法：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isScramble</span><span class="params">(<span class="built_in">string</span> s1, <span class="built_in">string</span> s2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isScramble(s1, <span class="number">0</span>, s1.size() - <span class="number">1</span>, s2, <span class="number">0</span>, s2.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isScramble</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s1, <span class="keyword">int</span> a1, <span class="keyword">int</span> b1, <span class="keyword">const</span> <span class="built_in">string</span>&amp; s2, <span class="keyword">int</span> a2, <span class="keyword">int</span> b2)</span> </span>&#123;        </span><br><span class="line">        <span class="keyword">if</span> (a1 == b1) &#123;</span><br><span class="line">            <span class="keyword">return</span> s1[a1] == s2[a2];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (b1 - a1 != b2 - a2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        vector&lt;int&gt; t1(26, 0), t2(26, 0);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = a1; i &lt;= b1; ++i) &#123;</span><br><span class="line">            ++t1[s1[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = a2; i &lt;= b2; ++i) &#123;</span><br><span class="line">            ++t2[s2[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (t1 != t2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> n = b1 - a1 + <span class="number">1</span>;</span><br><span class="line">        vector&lt;int&gt; l1(26, 0), r1(26, 0), l2(26, 0), r2(26, 0);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + <span class="number">1</span> &lt; n; ++i) &#123;</span><br><span class="line">            ++l1[s1[a1 + i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            ++r1[s1[b1 - i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            ++l2[s2[a2 + i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            ++r2[s2[b2 - i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 13, 24</span></span><br><span class="line">            <span class="keyword">if</span> (l1 == l2) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isScramble(s1, a1, a1 + i, s2, a2, a2 + i) &amp;&amp; isScramble(s1, a1 + i + <span class="number">1</span>, b1, s2, a2 + i + <span class="number">1</span>, b2)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 14, 23</span></span><br><span class="line">            <span class="keyword">if</span> (l1 == r2) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isScramble(s1, a1, a1 + i, s2, b2 - i, b2) &amp;&amp; isScramble(s1, a1 + i + <span class="number">1</span>, b1, s2, a2, b2 - i <span class="number">-1</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 23, 14</span></span><br><span class="line">            <span class="keyword">if</span> (l2 == r1) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isScramble(s1, b1 - i, b1, s2, a2, a2 + i) &amp;&amp; isScramble(s1, a1, b1 - i - <span class="number">1</span>, s2, a2 + i +<span class="number">1</span>, b2)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>对于这个题目，定义动态规划数组确相当不容易，因为在任何一步都是可以调换切分前后部分的。这里，我们定义dp[i][j][k]为s1中的[i, i + k - 1]和s2中的[j, j + k - 1]是否匹配。这个定义非常巧妙，它可以表示s1中任意的[a, b]和s2中的[c,d]的匹配关系。在最直接的思想下，要想表示两个任意的区间需要四维状态，但是因为我们有一个额外的约束：两个区间的长度是一样的，所以我们使用三维数组表示了这个状态。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isScramble</span><span class="params">(<span class="built_in">string</span> s1, <span class="built_in">string</span> s2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s1.size() != s2.size()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (s1 == s2) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">int</span> n = s1.size();</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;&gt;&gt; <span class="title">dp</span> <span class="params">(n, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;&gt;(n, <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;(n + <span class="number">1</span>)))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= n; ++len) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - len; ++i) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n - len; ++j) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (len == <span class="number">1</span>) &#123;</span><br><span class="line">                        dp[i][j][<span class="number">1</span>] = s1[i] == s2[j];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; len; ++k) &#123;</span><br><span class="line">                            <span class="keyword">if</span> ((dp[i][j][k] &amp;&amp; dp[i + k][j + k][len - k]) || (dp[i + k][j][len - k] &amp;&amp; dp[i][j + len - k][k])) &#123;</span><br><span class="line">                                dp[i][j][len] = <span class="literal">true</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;                </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>






<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ul>
<li>Leetcode算法题总结之区间dp， <a target="_blank" rel="noopener" href="https://www.cnblogs.com/54hys/p/13505616.html">https://www.cnblogs.com/54hys/p/13505616.html</a></li>
<li>acwing, <a target="_blank" rel="noopener" href="https://www.acwing.com/solution/LeetCode/content/1127/">https://www.acwing.com/solution/LeetCode/content/1127/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/02/14/longest_common_increasing_subsequence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/14/longest_common_increasing_subsequence/" class="post-title-link" itemprop="url">最长公共递增子序列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-14 22:18:34 / 修改时间：22:57:10" itemprop="dateCreated datePublished" datetime="2021-02-14T22:18:34+08:00">2021-02-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最长公共递增子序列(Longest Common Increasing Subsequence, LCIS)是<a target="_blank" rel="noopener" href="https://leehengtong.com/2021/02/06/longest_common_subsequence/">LCS</a>和<a target="_blank" rel="noopener" href="https://leehengtong.com/2021/02/14/longest_increasing_subsequence/">LIS</a>的结合体，比这两个基本形式都复杂一些。下面我们将以一道GeeksForGeeks上面的题目对这个问题进行解析和求解。</p>
<h3 id="GeeksForGeeks-Longest-Common-Increasing-Subsequence-LCS-LIS"><a href="#GeeksForGeeks-Longest-Common-Increasing-Subsequence-LCS-LIS" class="headerlink" title="GeeksForGeeks: Longest Common Increasing Subsequence (LCS + LIS)"></a><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/longest-common-increasing-subsequence-lcs-lis/">GeeksForGeeks: Longest Common Increasing Subsequence (LCS + LIS)</a></h3><blockquote>
<p>Given two arrays, find length of the longest common increasing subsequence [LCIS] and print one of such sequences (multiple sequences may exist)</p>
<p>Suppose we consider two arrays:<br>arr1[] = {3, 4, 9, 1} and<br>arr2[] = {5, 3, 8, 9, 10, 2, 1}</p>
<p>Our answer would be {3, 9} as this is the longest common subsequence which is increasing also.</p>
</blockquote>
<p>对于这个题目，我们仍然使用动态规划来求解，只不过我们使用一维数组来隐含的表示二维状态。我们先给出代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>&#123;</span>   </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">LCIS</span><span class="params">(<span class="keyword">int</span> arr1[], <span class="keyword">int</span> m, <span class="keyword">int</span> arr2[], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">data</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> cur = <span class="number">0</span>;  <span class="comment">// The current max LCIS length without using arr1[i] </span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;            </span><br><span class="line">                <span class="keyword">if</span> (arr1[i] == arr2[j]) &#123;  <span class="comment">// We can construct a longer LCIS end with arr2[j] using arr1[i] </span></span><br><span class="line">                    <span class="keyword">if</span> (cur + <span class="number">1</span> &gt; data[j]) &#123;</span><br><span class="line">                        data[j] = cur + <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (arr1[i] &gt; arr2[j]) &#123;  <span class="comment">// We found a longer LCIS to which the arr1[i] can append</span></span><br><span class="line">                    <span class="keyword">if</span> (data[j] &gt; cur) &#123;</span><br><span class="line">                        cur = data[j];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> *<span class="built_in">std</span>::max_element(data.begin(), data.end());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>其中，在第二个for循环里面，(1) data[j]表示由arr1[0…i]和arr2[0…j]所形成的最长LCIS的长度; (2) cur表示由arr1[0…i-1]和arr2[0…j]所形成的并且arr1[i]可以加在其后的最长的LCIS的长度。</p>
<ul>
<li>当当前的arr1[i]和arr2[j]相等时，如果新形成的LCIS的长度大于已有的以arr2[j]结尾的LCIS，更新data[j];</li>
<li>如果以arr2[j]结尾的LCIS的长度大于cur，并且arr1[i]可以放在这个LCIS的尾端的时候，我们认为在后续循环中以这个LCIS为基础来构造更长的LCIS,所以更新cur的值；</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/02/14/longest_increasing_subsequence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/14/longest_increasing_subsequence/" class="post-title-link" itemprop="url">最长递增子序列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-14 10:18:34 / 修改时间：22:57:29" itemprop="dateCreated datePublished" datetime="2021-02-14T10:18:34+08:00">2021-02-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最长递增子序列(Longest Increasing Subsequence, LIS)属于最基本也是最经典的动态规划问题，下面我们将以一道LeetCode上面的题目对这个问题进行解析和求解。</p>
<h3 id="leetcode-300-Longest-Increasing-Subsequence"><a href="#leetcode-300-Longest-Increasing-Subsequence" class="headerlink" title="leetcode 300: Longest Increasing Subsequence"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/longest-increasing-subsequence/">leetcode 300: Longest Increasing Subsequence</a></h3><blockquote>
<p>Given an integer array nums, return the length of the longest strictly increasing subsequence.</p>
<p>A subsequence is a sequence that can be derived from an array by deleting some or no elements without changing the order of the remaining elements. For example, [3,6,2,7] is a subsequence of the array [0,3,1,6,2,2,7].</p>
<p>Example 1:<br>Input: nums = [10,9,2,5,3,7,101,18]<br>Output: 4<br>Explanation: The longest increasing subsequence is [2,3,7,101], therefore the length is 4.</p>
<p>Example 2:<br>Input: nums = [0,1,0,3,2,3]<br>Output: 4</p>
<p>Example 3:<br>Input: nums = [7,7,7,7,7,7,7]<br>Output: 1</p>
<p>Constraints:<br>1 &lt;= nums.length &lt;= 2500<br>-104 &lt;= nums[i] &lt;= 104</p>
<p>Follow up:</p>
<ul>
<li>Could you come up with the $O(n^2)$ solution?</li>
<li>Could you improve it to $O(n log(n))$ time complexity?</li>
</ul>
</blockquote>
<p>一种符合直觉的算法是$O(n^2)$的算法，这也是会被大多数ACMer所鄙视的一种算法。我们可以使用一个数组data来表示以每个数字结尾的最长LIS的大小，即data[i]表示以nums[i]结尾的最长的LIS的长度。在计算nums[i]对应的data[i]的时候，我们只需要遍历每一个在i前面的数字nums[j],如果nums[j] &lt; nums[i], 那么就把nums[i]可以放在nums[j]的任意LIS后面，并把这个LIS的长度加1，从而可以以此更新nums[i]对应的data[i]. 具体代码如下所示：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">data</span><span class="params">(nums.size(), <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">int</span> res = nums.empty() ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[j] &lt; nums[i]) &#123;</span><br><span class="line">                    data[i] = max(data[i], data[j] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            res = max(res, data[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>为了获得一个$O(n log(n))$的算法，我们可以对上面的算法进行优化，即对7-11行的查找过程进行优化，实现$O(logn)$的查找。不过，下面我们给出另外一个不同思路的算法。在这个算法中，我们不是直接去构造LIS，而是维护一个数据结构data，data[i]表示对于长度为$i+1$的LIS，其结尾的数字最小可以是多少。让我们先看一下算法实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : nums) &#123;</span><br><span class="line">            <span class="keyword">auto</span> pos = lower_bound(data.begin(), data.end(), i);</span><br><span class="line">            <span class="keyword">if</span> (pos == data.end()) &#123;</span><br><span class="line">                data.push_back(i);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (*pos &gt; i) &#123;</span><br><span class="line">                    *pos = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> data.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>请注意最终的data并不是一个LIS，但是data的长度却表示可以构造的最长的LIS。下面我们以[10,9,2,5,3,7,101,18]为例进行推演一下：</p>
<ol>
<li>i = 10, data = [], pos = 0 -&gt; data = [10]</li>
<li>i = 9, data = [10], pos = 0 -&gt; data = [9]</li>
<li>i = 2, data = [9], pos = 0 -&gt; data = [2]</li>
<li>i = 5, data = [2], pos = 1 -&gt; data = [2, 5]</li>
<li>i = 3, data = [2, 5], pos = 1 -&gt; data = [2, 3]</li>
<li>i = 7, data = [2, 3], pos = 2 -&gt; data = [2, 3, 7]</li>
<li>i = 101, data = [2, 3, 7], pos = 3 -&gt; data = [2, 3, 7, 101]</li>
<li>i = 18, data = [2, 3, 7, 101], pos = 3 -&gt; data = [2, 3, 7, 18]</li>
</ol>
<p>两种典型的更新体现在第5步和第7步：第5步的更新使得LIS的结尾数字更小；第7步的更新加长LIS</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/02/06/longest_common_subsequence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/06/longest_common_subsequence/" class="post-title-link" itemprop="url">最长公共子序列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-06 10:18:34" itemprop="dateCreated datePublished" datetime="2021-02-06T10:18:34+08:00">2021-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-14 22:57:19" itemprop="dateModified" datetime="2021-02-14T22:57:19+08:00">2021-02-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最长公共子序列(Longest Common Subsequence, LCS)属于最基本也是最经典的动态规划问题，下面我们将以一道LeetCode上面的题目对这个问题进行解析和求解。</p>
<h3 id="leetcode-1143-Longest-Common-Subsequence"><a href="#leetcode-1143-Longest-Common-Subsequence" class="headerlink" title="leetcode 1143: Longest Common Subsequence"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/longest-common-subsequence/">leetcode 1143: Longest Common Subsequence</a></h3><blockquote>
<p>Given two strings text1 and text2, return the length of their longest common subsequence.</p>
<p>A subsequence of a string is a new string generated from the original string with some characters(can be none) deleted without changing the relative order of the remaining characters. (eg, “ace” is a &gt; subsequence of “abcde” while “aec” is not). A common subsequence of two strings is a subsequence that is common to both strings.</p>
<p>If there is no common subsequence, return 0.</p>
<p>Example 1:<br>Input: text1 = “abcde”, text2 = “ace”<br>Output: 3<br>Explanation: The longest common subsequence is “ace” and its length is 3.</p>
<p>Example 2:<br>Input: text1 = “abc”, text2 = “abc”<br>Output: 3<br>Explanation: The longest common subsequence is “abc” and its length is 3.</p>
<p>Example 3:<br>Input: text1 = “abc”, text2 = “def”<br>Output: 0<br>Explanation: There is no such common subsequence, so the result is 0.</p>
<p>Constraints:<br>1 &lt;= text1.length &lt;= 1000<br>1 &lt;= text2.length &lt;= 1000</p>
<p>The input strings consist of lowercase English characters only.</p>
</blockquote>
<p>这个题目比较好理解，我们首先建立一个二维的data数组，data数组中的每一个元素data[i][j]表示text1中的前i个字符和text2中的前j个字符的最长公共子序列的个数。那么对于data[i][j]我们有以下的递推关系：</p>
<ul>
<li>如果text1[i-1]和text[j-1]相同，那么data[i][j] = data[i-1][j-1] + 1</li>
<li>如果text1[i-1]和text[j-1]不相同，那么data[i][j] = max(data[i-1][j], data[i][j-1])</li>
</ul>
<p>具体的代码如下所示：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestCommonSubsequence</span><span class="params">(<span class="built_in">string</span> text1, <span class="built_in">string</span> text2)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">data</span><span class="params">(text1.size() + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(text2.size() + <span class="number">1</span>, <span class="number">0</span>))</span></span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; text1.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; text2.size(); ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (text1[i] == text2[j]) &#123;</span><br><span class="line">                    data[i+<span class="number">1</span>][j+<span class="number">1</span>] = data[i][j] + <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    data[i+<span class="number">1</span>][j+<span class="number">1</span>] = max(data[i][j+<span class="number">1</span>], data[i+<span class="number">1</span>][j]);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                res = max(res, data[i+<span class="number">1</span>][j+<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/02/01/modern_neovim/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/01/modern_neovim/" class="post-title-link" itemprop="url">Modern (Neo)vim congiure in 2021</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-01 22:18:34" itemprop="dateCreated datePublished" datetime="2021-02-01T22:18:34+08:00">2021-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-14 13:34:50" itemprop="dateModified" datetime="2021-02-14T13:34:50+08:00">2021-02-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vim/" itemprop="url" rel="index"><span itemprop="name">vim</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>I have used (neo)vim for many years. I think it greatly improved my work efficiency. And I want to share my configure with others to make more people can benefit from the (neo)vim.</p>
<p>As you may have noticed, I use (neo)vim to denote the vim. That is because I have switched to the neovim several months ago. I don’t want to compare which one is better, both of them are very good editors, and many programmers contributed a lot for them. For me, I switch to the neovim for the following reasons:</p>
<ul>
<li>I think the neovim will introduce new features more positively, I am willing to try the new functions.</li>
<li>I think the neovim is more friendly to the developers, I hope I can also contribute to it.</li>
<li>There are some new features in the neovim, e.g., terminal, asynchronous job, float windows, etc. Although, they are also introduced in the newer vim.</li>
</ul>
<p>I am a C/C++ programmer, so my configure is mainly for the C/C++. But, I think it can also work for common usage. And you can add some specific language support configure to it. Just as the title, “Modern (Neo)vim configure in 2021”, I gradually upgraded the plugins in the past year. Many excellent plugins have been replaced by better ones. The modern plugins always boring a more friendly GUI and better performance. There is no destination for this, I will also update this post when necessary.</p>
<p>In the next, I will directly give my init.vim with heavy comment to describe the configuration purposes. And in the last, I will also post a demo video.</p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&quot; Copyright 2018. All rights reserved.</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"><span class="comment">&quot;   _,_ /_      ,____,         _,     .  ,____,   ,_   __</span></span><br><span class="line"><span class="comment">&quot; _(_/_/ (_   _/ / / (__(_/_    (_/__/__/ / / (__/ (__(_,_</span></span><br><span class="line"><span class="comment">&quot;                       _/_</span></span><br><span class="line"><span class="comment">&quot;                      (/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"><span class="comment">&quot; oh my .vimrc, the chart is generated from patorjk.com/software/taag/ with</span></span><br><span class="line"><span class="comment">&quot; JS Cursive and small slant front.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;  _   __             ____      ___  __          _</span></span><br><span class="line"><span class="comment">&quot; | | / /_ _____  ___/ / /__   / _ \/ /_ _____ _(_)__  ___</span></span><br><span class="line"><span class="comment">&quot; | |/ / // / _ \/ _  / / -_) / ___/ / // / _ `/ / _ \(_-&lt;</span></span><br><span class="line"><span class="comment">&quot; |___/\_,_/_//_/\_,_/_/\__/ /_/  /_/\_,_/\_, /_/_//_/___/</span></span><br><span class="line"><span class="comment">&quot;                                         /___/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; The plugins for the coc.nvim</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:coc_global_extensions</span> = [</span><br><span class="line">\ <span class="string">&#x27;coc-snippets&#x27;</span>,</span><br><span class="line">\ <span class="string">&#x27;coc-clangd&#x27;</span>,</span><br><span class="line">\ <span class="string">&#x27;coc-tabnine&#x27;</span>,</span><br><span class="line">\ <span class="string">&#x27;coc-pyright&#x27;</span></span><br><span class="line">\ ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> plug#begin(<span class="built_in">has</span>(<span class="string">&#x27;nvim&#x27;</span>) ? <span class="string">&#x27;~/.config/nvim/plugged&#x27;</span> : <span class="string">&#x27;~/.vim/plugged&#x27;</span>)</span><br><span class="line"><span class="comment">&quot; Snipets</span></span><br><span class="line">Plug <span class="string">&#x27;honza/vim-snippets&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Color mark</span></span><br><span class="line">Plug <span class="string">&#x27;vim-scripts/ingo-library&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;WanGong/vim-mark&#x27;</span>  <span class="comment">&quot; require vim-scripts/ingo-library</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Nerdtree</span></span><br><span class="line">Plug <span class="string">&#x27;scrooloose/nerdtree&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;Xuyuanp/nerdtree-git-plugin&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;tiagofumo/vim-nerdtree-syntax-highlight&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Git</span></span><br><span class="line">Plug <span class="string">&#x27;tpope/vim-fugitive&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;junegunn/gv.vim&#x27;</span>  <span class="comment">&quot; require fugitive</span></span><br><span class="line">Plug <span class="string">&#x27;airblade/vim-gitgutter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Color scheme</span></span><br><span class="line">Plug <span class="string">&#x27;altercation/vim-colors-solarized&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;morhetz/gruvbox&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Auto brackets</span></span><br><span class="line">Plug <span class="string">&#x27;jiangmiao/auto-pairs&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;machakann/vim-sandwich&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Highlight display</span></span><br><span class="line">Plug <span class="string">&#x27;w0rp/ale&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;vim-python/python-syntax&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;octol/vim-cpp-enhanced-highlight&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;luochen1990/rainbow&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;ap/vim-css-color&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Move</span></span><br><span class="line">Plug <span class="string">&#x27;christoomey/vim-tmux-navigator&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;derekwyatt/vim-fswitch&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;easymotion/vim-easymotion&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;Yggdroot/LeaderF&#x27;</span>, &#123; <span class="string">&#x27;do&#x27;</span>: <span class="string">&#x27;:LeaderfInstallCExtension&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Status line</span></span><br><span class="line">Plug <span class="string">&#x27;vim-airline/vim-airline&#x27;</span>  <span class="comment">&quot; require vim-airline/vim-airline-themes</span></span><br><span class="line">Plug <span class="string">&#x27;vim-airline/vim-airline-themes&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;enricobacis/vim-airline-clock&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Code format</span></span><br><span class="line">Plug <span class="string">&#x27;sbdchd/neoformat&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;maksimr/vim-jsbeautify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Index</span></span><br><span class="line">Plug <span class="string">&#x27;ludovicchabant/vim-gutentags&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;majutsushi/tagbar&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Search</span></span><br><span class="line">Plug <span class="string">&#x27;junegunn/fzf&#x27;</span>, &#123; <span class="string">&#x27;do&#x27;</span>: &#123; -&gt; fzf#install() &#125; &#125;</span><br><span class="line">Plug <span class="string">&#x27;junegunn/fzf.vim&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;dyng/ctrlsf.vim&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Display</span></span><br><span class="line">Plug <span class="string">&#x27;godlygeek/tabular&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;Yggdroot/indentLine&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Comment</span></span><br><span class="line">Plug <span class="string">&#x27;preservim/nerdcommenter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Markdown</span></span><br><span class="line">Plug <span class="string">&#x27;masukomi/vim-markdown-folding&#x27;</span>, &#123; <span class="string">&#x27;for&#x27;</span>: <span class="string">&#x27;markdown&#x27;</span> &#125;</span><br><span class="line">Plug <span class="string">&#x27;iamcco/markdown-preview.nvim&#x27;</span>, &#123; <span class="string">&#x27;do&#x27;</span>: &#123; -&gt; mkdp#util#install() &#125;, <span class="string">&#x27;for&#x27;</span>: [<span class="string">&#x27;markdown&#x27;</span>, <span class="string">&#x27;vim-plug&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Coc</span></span><br><span class="line">Plug <span class="string">&#x27;neoclide/coc.nvim&#x27;</span>, &#123;<span class="string">&#x27;branch&#x27;</span>: <span class="string">&#x27;release&#x27;</span>, <span class="string">&#x27;do&#x27;</span>: &#123; -&gt; coc#util#install() &#125;&#125; <span class="comment">&quot; need nodejs and python support</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Terminal</span></span><br><span class="line">Plug <span class="string">&#x27;voldikss/vim-floaterm&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Scroll</span></span><br><span class="line">Plug <span class="string">&#x27;psliwka/vim-smoothie&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Icon</span></span><br><span class="line"><span class="comment">&quot; The requirements for vim-devicons:</span></span><br><span class="line"><span class="comment">&quot; (1) must be last one;</span></span><br><span class="line"><span class="comment">&quot; (2) install nerd font(https://github.com/ryanoasis/nerd-fonts);</span></span><br><span class="line"><span class="comment">&quot; (3) set terminal font</span></span><br><span class="line">Plug <span class="string">&#x27;ryanoasis/vim-devicons&#x27;</span></span><br><span class="line"><span class="keyword">call</span> plug#end()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;    ___           _       _____          ____</span></span><br><span class="line"><span class="comment">&quot;   / _ )___ ____ (_)___  / ___/__  ___  / _(_)__ _</span></span><br><span class="line"><span class="comment">&quot;  / _  / _ `(_-&lt;/ / __/ / /__/ _ \/ _ \/ _/ / _ `/</span></span><br><span class="line"><span class="comment">&quot; /____/\_,_/___/_/\__/  \___/\___/_//_/_//_/\_, /</span></span><br><span class="line"><span class="comment">&quot;                                           /___/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use rg to replace grep, please install the rg before to use this.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">executable</span>(<span class="string">&#x27;rg&#x27;</span>)</span><br><span class="line">    <span class="keyword">set</span> grepprg=rg\ --<span class="keyword">vimgrep</span>\ --<span class="keyword">no</span>-heading\ --smart-case</span><br><span class="line">    <span class="keyword">set</span> grepformat=%<span class="keyword">f</span>:%<span class="variable">l:</span>%<span class="keyword">c</span>:%<span class="keyword">m</span>,%<span class="keyword">f</span>:%<span class="variable">l:</span>%<span class="keyword">m</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="comment">&quot; Auto open the quickfix for the grep</span></span><br><span class="line"><span class="keyword">augroup</span> quickfix</span><br><span class="line">    autocmd!</span><br><span class="line">    <span class="keyword">autocmd</span> QuickFixCmdPost [^<span class="keyword">l</span>]* <span class="keyword">cwindow</span></span><br><span class="line">    <span class="keyword">autocmd</span> QuickFixCmdPost <span class="keyword">l</span>* <span class="keyword">lwindow</span></span><br><span class="line"><span class="keyword">augroup</span> END</span><br><span class="line"></span><br><span class="line"><span class="keyword">filetype</span> plugin <span class="built_in">indent</span> <span class="keyword">on</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">has</span>(<span class="string">&#x27;termguicolors&#x27;</span>)</span><br><span class="line">  <span class="keyword">set</span> termguicolors</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mapleader=<span class="string">&#x27;;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">syntax</span> enable</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> expandtab</span><br><span class="line"><span class="keyword">set</span> <span class="built_in">shiftwidth</span>=<span class="number">2</span></span><br><span class="line"><span class="keyword">set</span> softtabstop=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">number</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">history</span>=<span class="number">1000</span> <span class="comment">&quot; History command number</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> autoindent</span><br><span class="line"><span class="keyword">set</span> <span class="built_in">cindent</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> encoding=utf-<span class="number">8</span></span><br><span class="line"><span class="keyword">set</span> clipboard=unnamed</span><br><span class="line">set tags=tags;/ &quot; The &#x27;;&#x27; is used to find tags in parent dir</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> incsearch</span><br><span class="line"><span class="keyword">set</span> hlsearch <span class="comment">&quot; Highlight search result</span></span><br><span class="line"><span class="keyword">highlight</span> Search ctermbg=LightYellow ctermfg=Red cterm=bold,italic guibg=LightYellow guifg=Red <span class="keyword">gui</span>=bold,italic</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> cursorline</span><br><span class="line"><span class="keyword">set</span> backspace=<span class="built_in">indent</span>,eol,start</span><br><span class="line"><span class="keyword">set</span> matchpairs+=&lt;:&gt;</span><br><span class="line"><span class="keyword">highlight</span> MatchParen ctermbg=green ctermfg=blue guibg=green guifg=blue</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Code fold setting: za: on/off current fold, zM: off all folds, zR: on all folds</span></span><br><span class="line"><span class="keyword">set</span> foldmethod=<span class="keyword">syntax</span></span><br><span class="line"><span class="keyword">set</span> nofoldenable <span class="comment">&quot; on/off</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> colorcolumn=<span class="number">80</span> <span class="comment">&quot; The code width line</span></span><br><span class="line"><span class="keyword">highlight</span> ColorColumn ctermbg=DarkGray guibg=LightGray</span><br><span class="line"><span class="keyword">highlight</span> clear SpellBad</span><br><span class="line"><span class="keyword">highlight</span> SpellBad cterm=underline,italic <span class="keyword">gui</span>=underline,italic</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> smartcase</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Backup config</span></span><br><span class="line"><span class="keyword">set</span> backup</span><br><span class="line"><span class="keyword">set</span> backupdir=~/.<span class="keyword">vim</span>/backup/</span><br><span class="line"><span class="keyword">set</span> writebackup <span class="comment">&quot; Make backup before overwriting the current buffer</span></span><br><span class="line"><span class="keyword">set</span> backupcopy=yes <span class="comment">&quot; Overwrite the original backup file</span></span><br><span class="line"><span class="comment">&quot; The backup file name, e.g. filename@2015-04-05.14:59</span></span><br><span class="line"><span class="keyword">au</span> BufWritePre * <span class="keyword">let</span> &amp;bex = <span class="string">&#x27;@&#x27;</span> . <span class="built_in">strftime</span>(<span class="string">&quot;%F.%H:%M&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Vim terminal</span></span><br><span class="line"><span class="keyword">set</span> splitbelow</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Fix crazy wrong code, ref to:</span></span><br><span class="line"><span class="comment">&quot; https://www.reddit.com/r/vim/comments/gv410k/strange_character_since_last_update_42m/fsmfxxv/</span></span><br><span class="line"><span class="keyword">let</span> &amp;t_TI = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">let</span> &amp;t_TE = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> background=dark</span><br><span class="line"><span class="keyword">colorscheme</span> gruvbox</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;    ____    _____  ____        _      __</span></span><br><span class="line"><span class="comment">&quot;   / __/__ / / _/ / __/_______(_)__  / /____</span></span><br><span class="line"><span class="comment">&quot;  _\ \/ -_) / _/ _\ \/ __/ __/ / _ \/ __(_-&lt;</span></span><br><span class="line"><span class="comment">&quot; /___/\__/_/_/  /___/\__/_/ /_/ .__/\__/___/</span></span><br><span class="line"><span class="comment">&quot;                             /_/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Highlight all instances of word under cursor</span></span><br><span class="line"><span class="comment">&quot; Type z/ to toggle highlighting on/off.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">AutoHighlightToggle</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">let</span> @/ = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">exists</span>(<span class="string">&#x27;#auto_highlight&#x27;</span>)</span><br><span class="line">    au! auto_highlight</span><br><span class="line">    augroup! auto_highlight</span><br><span class="line">    <span class="keyword">setl</span> updatetime=<span class="number">4000</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Highlight current word: off&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">augroup</span> auto_highlight</span><br><span class="line">      au!</span><br><span class="line">      <span class="keyword">au</span> CursorHold * <span class="keyword">let</span> @/ = <span class="string">&#x27;\V\&lt;&#x27;</span>.<span class="built_in">escape</span>(<span class="built_in">expand</span>(<span class="string">&#x27;&lt;cword&gt;&#x27;</span>), <span class="string">&#x27;\&#x27;</span>).<span class="string">&#x27;\&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">augroup</span> end</span><br><span class="line">    <span class="keyword">setl</span> updatetime=<span class="number">500</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Highlight current word: ON&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">z</span>/ :<span class="keyword">if</span> AutoHighlightToggle()<span class="symbol">&lt;Bar&gt;</span><span class="keyword">set</span> hls<span class="symbol">&lt;Bar&gt;</span><span class="keyword">endif</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;    ___  __          _        _____          ____</span></span><br><span class="line"><span class="comment">&quot;   / _ \/ /_ _____ _(_)__    / ___/__  ___  / _(_)__ _</span></span><br><span class="line"><span class="comment">&quot;  / ___/ / // / _ `/ / _ \  / /__/ _ \/ _ \/ _/ / _ `/</span></span><br><span class="line"><span class="comment">&quot; /_/  /_/\_,_/\_, /_/_//_/  \___/\___/_//_/_//_/\_, /</span></span><br><span class="line"><span class="comment">&quot;             /___/                             /___/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For &#x27;sbdchd/neoformat&#x27;</span></span><br><span class="line"><span class="comment">&quot; The neoformat is used to format code, you should also install some</span></span><br><span class="line"><span class="comment">&quot; independent code formator(e.g., clang-format, pyling, etc.) in the system</span></span><br><span class="line"><span class="keyword">nnoremap</span> ff :Neoformat<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For &#x27;voldikss/vim-floaterm&#x27;</span></span><br><span class="line"><span class="comment">&quot; Usage: (1) toggle floaterm: tt;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_keymap_new</span>    = <span class="string">&#x27;&lt;leader&gt;tt&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_keymap_kill</span>   = <span class="string">&#x27;&lt;leader&gt;tk&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_keymap_prev</span>   = <span class="string">&#x27;&lt;leader&gt;tn&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_keymap_next</span>   = <span class="string">&#x27;&lt;leader&gt;tp&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_keymap_toggle</span> = <span class="string">&#x27;tt&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:floaterm_title</span>         = <span class="string">&#x27;$1/$2&#x27;</span></span><br><span class="line"></span><br><span class="line">tnoremap <span class="symbol">&lt;leader&gt;</span><span class="keyword">e</span> &lt;<span class="keyword">c</span>-\&gt;<span class="symbol">&lt;c-n&gt;</span>:FloatermNew<span class="symbol">&lt;cr&gt;</span></span><br><span class="line">tnoremap <span class="symbol">&lt;leader&gt;</span>q &lt;<span class="keyword">c</span>-\&gt;<span class="symbol">&lt;c-n&gt;</span>:FloatermKill<span class="symbol">&lt;cr&gt;</span></span><br><span class="line">tnoremap gt &lt;<span class="keyword">c</span>-\&gt;<span class="symbol">&lt;c-n&gt;</span>:FloatermNext<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For &#x27;airblade/vim-gitgutter&#x27;</span></span><br><span class="line"><span class="keyword">nmap</span> ]h <span class="symbol">&lt;Plug&gt;</span>(GitGutterNextHunk)</span><br><span class="line"><span class="keyword">nmap</span> [h <span class="symbol">&lt;Plug&gt;</span>(GitGutterPrevHunk)</span><br><span class="line"><span class="keyword">nmap</span> hp <span class="symbol">&lt;Plug&gt;</span>(GitGutterPreviewHunk)</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gitgutter_preview_win_floating</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For WanGong/vim-mark</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) mark current world: &lt;leader&gt;m;</span></span><br><span class="line"><span class="comment">&quot; (2) undo mark current world: &lt;leader&gt;m;</span></span><br><span class="line"><span class="comment">&quot; (3) cancel all: mm</span></span><br><span class="line"><span class="keyword">nnoremap</span> mm :MarkClear<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For leaderF</span></span><br><span class="line"><span class="comment">&quot; The Leaderf is quite powerful, which is a fully replace for the original CtrlP</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) search file: Ctrl-p;</span></span><br><span class="line"><span class="comment">&quot; (2) search recent opened file: Ctrl-u;</span></span><br><span class="line"><span class="comment">&quot; (3) search tag in current buffer: &lt;leader&gt;ft</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_ShortcutF</span> = <span class="string">&#x27;&lt;C-p&gt;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_UseCache</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_ShowDevIcons</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_PreviewInPopup</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_WildIgnore</span> = &#123;</span><br><span class="line">      \ <span class="string">&#x27;dir&#x27;</span>: [<span class="string">&#x27;.svn&#x27;</span>,<span class="string">&#x27;.git&#x27;</span>,<span class="string">&#x27;.hg&#x27;</span>,<span class="string">&#x27;.clangd&#x27;</span>],</span><br><span class="line">      \ <span class="string">&#x27;file&#x27;</span>: [<span class="string">&#x27;*.sw?&#x27;</span>,<span class="string">&#x27;~$*&#x27;</span>,<span class="string">&#x27;*.bak&#x27;</span>,<span class="string">&#x27;*.exe&#x27;</span>,<span class="string">&#x27;*.o&#x27;</span>,<span class="string">&#x27;*.so&#x27;</span>,<span class="string">&#x27;*.py[co]&#x27;</span>]</span><br><span class="line">      \&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_CommandMap</span> = &#123;<span class="string">&#x27;&lt;C-up&gt;&#x27;</span>: [<span class="string">&#x27;&lt;C-b&gt;&#x27;</span>], <span class="string">&#x27;&lt;C-down&gt;&#x27;</span>: [<span class="string">&#x27;&lt;C-f&gt;&#x27;</span>]&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:Lf_PreviewResult</span> = &#123; <span class="string">&#x27;Tag&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;BufTag&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;Function&#x27;</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>fb :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf buffer %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>ff :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf function %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>ft :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf bufTag %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>fl :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf line %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>fg :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf tag %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span>fc :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf colorscheme %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">u</span>  :<span class="symbol">&lt;C-U&gt;</span><span class="symbol">&lt;C-R&gt;</span>=<span class="built_in">printf</span>(<span class="string">&quot;Leaderf mru %s&quot;</span>, <span class="string">&quot;&quot;</span>)<span class="symbol">&lt;CR&gt;</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For &#x27;dyng/ctrlsf.vim&#x27;</span></span><br><span class="line"><span class="comment">&quot; ctrlsf is the ultimate global search tool.</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) search current word: K;</span></span><br><span class="line"><span class="comment">&quot; (2) switch display style: M(in result window);</span></span><br><span class="line"><span class="comment">&quot; (3) preview current result: Ctrl-p(in result window)</span></span><br><span class="line"><span class="comment">&quot; (4) custom search: &lt;leader&gt;s;</span></span><br><span class="line"><span class="comment">&quot; (5) toggle search reslt: cc</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_search_mode</span> = <span class="string">&#x27;async&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_preview_position</span> = <span class="string">&#x27;outside&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_populate_qflist</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_default_view_mode</span> = <span class="string">&#x27;compact&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_winsize</span> = <span class="string">&#x27;50%&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_compact_winsize</span> = <span class="string">&#x27;30%&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_auto_close</span> = &#123;</span><br><span class="line">    \ <span class="string">&quot;normal&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    \ <span class="string">&quot;compact&quot;</span>: <span class="number">0</span></span><br><span class="line">    \&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_auto_focus</span> = &#123; <span class="string">&quot;at&quot;</span>: <span class="string">&quot;start&quot;</span> &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_default_root</span> = <span class="string">&#x27;project&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_backend</span> = <span class="string">&#x27;rg&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ctrlsf_mapping</span> = &#123; <span class="string">&quot;popen&quot;</span>: <span class="string">&quot;&lt;C-P&gt;&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">cc</span> :CtrlSFToggle<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>s <span class="symbol">&lt;Plug&gt;</span>CtrlSFPrompt</span><br><span class="line"><span class="keyword">nmap</span> K <span class="symbol">&lt;Plug&gt;</span>CtrlSFCwordPath<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For derekwyatt/vim-fswitch</span></span><br><span class="line"><span class="comment">&quot; Usage: (1) switch head/source: Ctrl-f</span></span><br><span class="line"><span class="keyword">autocmd</span> FileType <span class="keyword">c</span>,cpp <span class="keyword">nnoremap</span> <span class="symbol">&lt;buffer&gt;</span> <span class="symbol">&lt;C-f&gt;</span> :FSHere<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">autocmd</span> FileType <span class="keyword">c</span>,cpp <span class="keyword">nnoremap</span> <span class="symbol">&lt;buffer&gt;</span> <span class="symbol">&lt;M-l&gt;</span> :FSSplitRight<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">autocmd</span> FileType <span class="keyword">c</span>,cpp <span class="keyword">nnoremap</span> <span class="symbol">&lt;buffer&gt;</span> <span class="symbol">&lt;M-h&gt;</span> :FSSplitLeft<span class="symbol">&lt;CR&gt;</span></span><br><span class="line">au! BufEnter *.<span class="keyword">cc</span> <span class="keyword">let</span> <span class="variable">b:fswitchdst</span> = <span class="string">&#x27;hh,h&#x27;</span></span><br><span class="line">au! BufEnter *.h <span class="keyword">let</span> <span class="variable">b:fswitchdst</span> = <span class="string">&#x27;c,cpp,m,cc&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For airline</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_theme</span>=<span class="string">&quot;deus&quot;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#enabled = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#tab_nr_type = <span class="number">1</span> <span class="comment">&quot; tab number</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#show_tab_nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#formatter = <span class="string">&#x27;jsformatter&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#buffer_nr_show = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#fnametruncate = <span class="number">16</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#fnamecollapse = <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#fnamemod = <span class="string">&#x27;:t&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#buffer_idx_mode = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#left_sep = <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#left_alt_sep = <span class="string">&#x27;|&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#show_tab_type = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#ale#enabled = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#ale#error_symbol = <span class="string">&#x27;✗: &#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#ale#warning_symbol = <span class="string">&#x27;⚠ : &#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#ale#show_line_numbers = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#hunks#enabled=<span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#branch#enabled=<span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_section_z</span>=airline#section#create([<span class="string">&#x27;%4l%#__restore__#%#__accent_bold#/%L%&#x27;</span>]) <span class="comment">&quot; show curline/total_line</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_skip_empty_sections</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_stl_path_style</span> = <span class="string">&#x27;short&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_section_c</span> = <span class="string">&#x27;%t&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_section_error</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_section_warning</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For airline-clock</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#clock#format = <span class="string">&#x27;%H:%M&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#clock#auto = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">AirlineInit</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">g:airline_section_a</span> = airline#section#create([<span class="string">&#x27;clock&#x27;</span>, <span class="variable">g:airline_symbols</span>.space, <span class="variable">g:airline_section_a</span>])</span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">autocmd</span> User AirlineAfterInit <span class="keyword">call</span> AirlineInit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For vim-gutentags</span></span><br><span class="line"><span class="comment">&quot; The gutentags is used to auto generate tag, it is still usefull for most,</span></span><br><span class="line"><span class="comment">&quot; as it is quite fast, although the match result maybe wrong at sometimes.</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) go to definition of current word: Ctrl-];</span></span><br><span class="line"><span class="comment">&quot; (2) go back: Ctrl-t</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Project root flag, stop to find in the parent dir</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_enabled</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_trace</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_project_root</span> = [<span class="string">&#x27;.root&#x27;</span>, <span class="string">&#x27;.svn&#x27;</span>, <span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;.hg&#x27;</span>, <span class="string">&#x27;.project&#x27;</span>, <span class="string">&#x27;package.json&#x27;</span>]</span><br><span class="line"><span class="comment">&quot; Tag file name</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_ctags_tagfile</span> = <span class="string">&#x27;tags&#x27;</span></span><br><span class="line"><span class="comment">&quot; Put the tags into ~/.cache/tags</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s:vim_tags</span> = <span class="built_in">expand</span>(<span class="string">&#x27;~/.cache/tags&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_cache_dir</span> = <span class="variable">s:vim_tags</span></span><br><span class="line"><span class="comment">&quot; Tags parameter</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_ctags_extra_args</span> = [<span class="string">&#x27;-R&#x27;</span>, <span class="string">&#x27;--fields=+niazS&#x27;</span>, <span class="string">&#x27;--extras=+q&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_ctags_extra_args</span> += [<span class="string">&#x27;--c++-kinds=+px&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_ctags_extra_args</span> += [<span class="string">&#x27;--c-kinds=+px&#x27;</span>]</span><br><span class="line"><span class="comment">&quot; let g:gutentags_ctags_extra_args += [&#x27;--language-force=C++&#x27;]</span></span><br><span class="line"><span class="comment">&quot; Create the dir if needed</span></span><br><span class="line"><span class="keyword">if</span> !isdirectory(<span class="variable">s:vim_tags</span>)</span><br><span class="line">   silent! <span class="keyword">call</span> <span class="built_in">mkdir</span>(<span class="variable">s:vim_tags</span>, <span class="string">&#x27;p&#x27;</span>)</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_add_default_project_roots</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_exclude_filetypes</span> = [<span class="string">&#x27;gitcommit&#x27;</span>, <span class="string">&#x27;gitconfig&#x27;</span>, <span class="string">&#x27;gitrebase&#x27;</span>, <span class="string">&#x27;gitsendemail&#x27;</span>, <span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;cmake&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_generate_on_new</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_generate_on_missing</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_generate_on_write</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_generate_on_empty_buffer</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Maybe also exclude &#x27;build&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:gutentags_ctags_exclude</span> = [</span><br><span class="line">\  <span class="string">&#x27;*.git&#x27;</span>, <span class="string">&#x27;*.svn&#x27;</span>, <span class="string">&#x27;*.hg&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;cache&#x27;</span>, <span class="string">&#x27;dist&#x27;</span>, <span class="string">&#x27;bin&#x27;</span>, <span class="string">&#x27;node_modules&#x27;</span>, <span class="string">&#x27;bower_components&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*-lock.json&#x27;</span>,  <span class="string">&#x27;*.lock&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.min.*&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;CMakeLists.txt&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.bak&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.zip&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.pyc&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.class&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.sln&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.csproj&#x27;</span>, <span class="string">&#x27;*.csproj.user&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.tmp&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.cache&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.vscode&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.pdb&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.pb&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.exe&#x27;</span>, <span class="string">&#x27;*.dll&#x27;</span>, <span class="string">&#x27;*.bin&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.mp3&#x27;</span>, <span class="string">&#x27;*.ogg&#x27;</span>, <span class="string">&#x27;*.flac&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.swp&#x27;</span>, <span class="string">&#x27;*.swo&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;.DS_Store&#x27;</span>, <span class="string">&#x27;*.plist&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.bmp&#x27;</span>, <span class="string">&#x27;*.gif&#x27;</span>, <span class="string">&#x27;*.ico&#x27;</span>, <span class="string">&#x27;*.jpg&#x27;</span>, <span class="string">&#x27;*.png&#x27;</span>, <span class="string">&#x27;*.svg&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.rar&#x27;</span>, <span class="string">&#x27;*.zip&#x27;</span>, <span class="string">&#x27;*.tar&#x27;</span>, <span class="string">&#x27;*.tar.gz&#x27;</span>, <span class="string">&#x27;*.tar.xz&#x27;</span>, <span class="string">&#x27;*.tar.bz2&#x27;</span>,</span><br><span class="line">\  <span class="string">&#x27;*.pdf&#x27;</span>, <span class="string">&#x27;*.doc&#x27;</span>, <span class="string">&#x27;*.docx&#x27;</span>, <span class="string">&#x27;*.ppt&#x27;</span>, <span class="string">&#x27;*.pptx&#x27;</span>, <span class="string">&#x27;*.xls&#x27;</span>,</span><br><span class="line">\]</span><br><span class="line"></span><br><span class="line"><span class="string">&quot; Add &quot;</span><span class="string">&#x27;detach&#x27;</span>: <span class="number">1</span>,<span class="comment">&quot; to the build_default_job_options in autoload/gutentags.vim</span></span><br><span class="line"><span class="comment">&quot; ref to:</span></span><br><span class="line"><span class="comment">&quot; https://github.com/ludovicchabant/vim-gutentags/issues/178</span></span><br><span class="line"><span class="comment">&quot; https://github.com/ludovicchabant/vim-gutentags/issues/167</span></span><br><span class="line"><span class="comment">&quot; https://github.com/ludovicchabant/vim-gutentags/issues/168</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For ale</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_set_highlights</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_lint_on_text_changed</span> = <span class="string">&#x27;never&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_lint_on_enter</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_sign_column_always</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_sign_error</span> = <span class="string">&#x27;✗&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_sign_warning</span> = <span class="string">&#x27;⚠&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:ale_linters</span> = &#123;</span><br><span class="line">    \   <span class="string">&#x27;c++&#x27;</span>: [<span class="string">&#x27;clang&#x27;</span>],</span><br><span class="line">    \   <span class="string">&#x27;c&#x27;</span>: [<span class="string">&#x27;clang&#x27;</span>],</span><br><span class="line">    \   <span class="string">&#x27;python&#x27;</span>: [<span class="string">&#x27;pylint&#x27;</span>],</span><br><span class="line">    \&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For cpp highlight</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:cpp_class_scope_highlight</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:cpp_member_variable_highlight</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:cpp_class_decl_highlight</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:cpp_experimental_template_highlight</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:cpp_concepts_highlight</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For NERDTree</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) find current file in the nerdtree: &lt;leader&gt;n;</span></span><br><span class="line"><span class="comment">&quot; (2) toggle nerdtree: Ctrl-n</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeMinimalUI=<span class="number">1</span> <span class="comment">&quot; remove the first line help info</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeWinSize=<span class="number">40</span>  <span class="comment">&quot; set width</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeHighlightCursorline=<span class="number">1</span> <span class="comment">&quot; does not highlight the cursor of current file</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeChDirMode = <span class="number">2</span> <span class="comment">&quot; setting for current directory</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Auto quit NERDTree when vim is quited</span></span><br><span class="line"><span class="keyword">autocmd</span> bufenter * <span class="keyword">if</span> (<span class="built_in">winnr</span>(<span class="string">&quot;$&quot;</span>) == <span class="number">1</span> &amp;&amp; <span class="built_in">exists</span>(<span class="string">&quot;b:NERDTreeType&quot;</span>) &amp;&amp;<span class="variable">b:NERDTreeType</span> == <span class="string">&quot;primary&quot;</span>) | q | <span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;C-n&gt;</span> :NERDTreeToggle<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span>n :NERDTreeFind<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDTreeDirArrowExpandable</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDTreeDirArrowCollapsible</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For tagbar</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) toggle tagbar: tb;</span></span><br><span class="line"><span class="comment">&quot; (2) preview current tag: p(in tagbar window);</span></span><br><span class="line"><span class="comment">&quot; (3) toggle maximize tagbar window: x(in tagbar window)</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:tagbar_compact</span> = <span class="number">1</span> <span class="comment">&quot; remove the first line help info</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:tagbar_width</span> = <span class="number">30</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:tagbar_autoshowtag</span> = <span class="number">1</span> <span class="comment">&quot; auto highlight tags when edit file</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:tagbar_iconchars</span> = [<span class="string">&#x27;▸&#x27;</span>, <span class="string">&#x27;▾&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> tb :TagbarToggle<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For luochen1990/rainbow</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:rainbow_active</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:rainbow_conf</span> = &#123;</span><br><span class="line">\	<span class="string">&#x27;separately&#x27;</span>: &#123;</span><br><span class="line">\		<span class="string">&#x27;nerdtree&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">\	&#125;</span><br><span class="line">\&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For preservim/nerdcommenter</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) toggle comment current line: &lt;leader&gt;c&lt;space&gt;</span></span><br><span class="line"><span class="comment">&quot; Create default mappings</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCreateDefaultMappings</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Add spaces after comment delimiters by default</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDSpaceDelims</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Use compact syntax for prettified multi-line comments</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCompactSexyComs</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Align line-wise comment delimiters flush left instead of following code indentation</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDDefaultAlign</span> = <span class="string">&#x27;left&#x27;</span></span><br><span class="line"><span class="comment">&quot; Set a language to use its alternate delimiters by default</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDAltDelims_java</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Add your own custom formats or override the defaults</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCustomDelimiters</span> = &#123; <span class="string">&#x27;c&#x27;</span>: &#123; <span class="string">&#x27;left&#x27;</span>: <span class="string">&#x27;/**&#x27;</span>,<span class="string">&#x27;right&#x27;</span>: <span class="string">&#x27;*/&#x27;</span> &#125; &#125;</span><br><span class="line"><span class="comment">&quot; Allow commenting and inverting empty lines (useful when commenting a region)</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCommentEmptyLines</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Enable trimming of trailing whitespace when uncommenting</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDTrimTrailingWhitespace</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; Enable NERDCommenterToggle to check all selected lines is commented or not</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDToggleCheckAllLines</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; For coc.nvim</span></span><br><span class="line"><span class="comment">&quot; The coc.nvim is a powerful LSP, https://github.com/neoclide/coc.nvim</span></span><br><span class="line"><span class="comment">&quot; Usage: (1) go to definition: gd; (2) go back: Ctrl-o</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; TextEdit might fail if hidden is not set.</span></span><br><span class="line"><span class="keyword">set</span> hidden</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Some servers have issues with backup files, see #649.</span></span><br><span class="line"><span class="keyword">set</span> nobackup</span><br><span class="line"><span class="keyword">set</span> nowritebackup</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Give more space for displaying messages.</span></span><br><span class="line"><span class="keyword">set</span> cmdheight=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable</span></span><br><span class="line"><span class="comment">&quot; delays and poor user experience.</span></span><br><span class="line"><span class="keyword">set</span> updatetime=<span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Don&#x27;t pass messages to |ins-completion-menu|.</span></span><br><span class="line"><span class="keyword">set</span> shortmess+=<span class="keyword">c</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Recently vim can merge signcolumn and number column into one</span></span><br><span class="line"><span class="string">&quot; set signcolumn=yes &quot;</span>default <span class="keyword">to</span> <span class="keyword">be</span> auto</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use tab for trigger completion with characters ahead and navigate.</span></span><br><span class="line"><span class="comment">&quot; <span class="doctag">NOTE:</span> Use command &#x27;:verbose imap &lt;tab&gt;&#x27; to make sure tab is not mapped by</span></span><br><span class="line"><span class="comment">&quot; other plugin before putting this into your config.</span></span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;TAB&gt;</span></span><br><span class="line">      \ <span class="built_in">pumvisible</span>() ? <span class="string">&quot;\&lt;C-n&gt;&quot;</span> :</span><br><span class="line">      \ <span class="symbol">&lt;SID&gt;</span>check_back_space() ? <span class="string">&quot;\&lt;TAB&gt;&quot;</span> :</span><br><span class="line">      \ coc#refresh()</span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;expr&gt;</span><span class="symbol">&lt;S-TAB&gt;</span> <span class="built_in">pumvisible</span>() ? <span class="string">&quot;\&lt;C-p&gt;&quot;</span> : <span class="string">&quot;\&lt;C-h&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">s</span>:<span class="title">check_back_space</span><span class="params">()</span> <span class="title">abort</span></span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">col</span> = <span class="keyword">col</span>(<span class="string">&#x27;.&#x27;</span>) - <span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> !col || <span class="built_in">getline</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="keyword">col</span> - <span class="number">1</span>]  =~# <span class="string">&#x27;\s&#x27;</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Make &lt;CR&gt; auto-select the first completion item and notify coc.nvim to</span></span><br><span class="line"><span class="comment">&quot; format on enter, &lt;cr&gt; could be remapped by other vim plugin</span></span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;cr&gt;</span> <span class="built_in">pumvisible</span>() ? coc#_select_confirm()</span><br><span class="line">                              \: <span class="string">&quot;\&lt;C-g&gt;u\&lt;CR&gt;\&lt;c-r&gt;=coc#on_enter()\&lt;CR&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; GoTo code navigation.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gd <span class="symbol">&lt;Plug&gt;</span>(coc-definition)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gy <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="built_in">type</span>-definition)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gi <span class="symbol">&lt;Plug&gt;</span>(coc-implementation)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="keyword">gr</span> <span class="symbol">&lt;Plug&gt;</span>(coc-references)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Highlight the symbol and its references when holding the cursor.</span></span><br><span class="line"><span class="keyword">autocmd</span> CursorHold * <span class="keyword">silent</span> <span class="keyword">call</span> CocActionAsync(<span class="string">&#x27;highlight&#x27;</span>)</span><br><span class="line"><span class="keyword">autocmd</span> ColorScheme * <span class="keyword">highlight</span> CocHighlightText ctermfg=LightMagenta guifg=LightMagenta cterm=bold <span class="keyword">gui</span>=bold</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Add (Neo)Vim&#x27;s native statusline support.</span></span><br><span class="line"><span class="comment">&quot; <span class="doctag">NOTE:</span> Please see `:h coc-status` for integrations with external plugins that</span></span><br><span class="line"><span class="comment">&quot; provide custom statusline: lightline.vim, vim-airline.</span></span><br><span class="line"><span class="keyword">set</span> statusline^=%&#123;coc#status()&#125;%&#123;<span class="built_in">get</span>(<span class="variable">b:</span>,<span class="string">&#x27;coc_current_function&#x27;</span>,<span class="string">&#x27;&#x27;</span>)&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;   _____                __          _____          ____</span></span><br><span class="line"><span class="comment">&quot;  / ___/__  __ _  ___  / /____ __  / ___/__  ___  / _(_)__ _</span></span><br><span class="line"><span class="comment">&quot; / /__/ _ \/  &#x27; \/ _ \/ / -_) \ / / /__/ _ \/ _ \/ _/ / _ `/</span></span><br><span class="line"><span class="comment">&quot; \___/\___/_/_/_/ .__/_/\__/_\_\  \___/\___/_//_/_//_/\_, /</span></span><br><span class="line"><span class="comment">&quot;               /_/                                   /___/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Please run the following commands to config vimdiff for git d:</span></span><br><span class="line"><span class="comment">&quot; (1) git config --global  diff.tool vimdiff</span></span><br><span class="line"><span class="comment">&quot; (2) git config --global  difftool.prompt false</span></span><br><span class="line"><span class="comment">&quot; (3) git config --global  difftool.vimdiff.path nvim  # For nvim only</span></span><br><span class="line"><span class="comment">&quot; (4) git config --global  alias.d difftool</span></span><br><span class="line"><span class="comment">&quot; (1) git config --global  merge.tool vimdiff</span></span><br><span class="line"><span class="comment">&quot; (2) git config --global  mergetool.prompt false</span></span><br><span class="line"><span class="comment">&quot; (3) git config --global  mergetool.vimdiff.path nvim  # For nvim only</span></span><br><span class="line"><span class="comment">&quot; (4) git config --global  alias.m mergetool</span></span><br><span class="line"><span class="comment">&quot; Config the following to enable git trust vim exitcode, quit with :cquit</span></span><br><span class="line"><span class="comment">&quot; (1) git config --global  difftool.trustExitCode true</span></span><br><span class="line"><span class="comment">&quot; (2) git config --global  mergetool.trustExitCode true</span></span><br><span class="line"><span class="comment">&quot; Usage:</span></span><br><span class="line"><span class="comment">&quot; (1) git d for the vimdiff</span></span><br><span class="line"><span class="comment">&quot; (2) :qa for exit current file;</span></span><br><span class="line"><span class="comment">&quot; (3) :cq for interrupt the vimdiff</span></span><br><span class="line"><span class="keyword">if</span> !&amp;diff</span><br><span class="line">  <span class="keyword">autocmd</span> ColorScheme * <span class="keyword">highlight</span> ExtraWhitespace ctermbg=<span class="keyword">red</span> guibg=<span class="keyword">red</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; When the FileType is python, create a mapping to execute the current buffer</span></span><br><span class="line"><span class="keyword">autocmd</span> FileType <span class="keyword">python</span> <span class="keyword">nnoremap</span> <span class="symbol">&lt;buffer&gt;</span> <span class="keyword">P</span> :exec <span class="string">&#x27;!python&#x27;</span> <span class="built_in">shellescape</span>(@%, <span class="number">1</span>)<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Record the last postition, pulled from :help last-position-jump in vim</span></span><br><span class="line"><span class="keyword">autocmd</span> BufReadPost *</span><br><span class="line">  \ <span class="keyword">if</span> <span class="built_in">line</span>(<span class="string">&quot;&#x27;\&quot;&quot;</span>) &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">line</span>(<span class="string">&quot;&#x27;\&quot;&quot;</span>) &lt;= <span class="built_in">line</span>(<span class="string">&quot;$&quot;</span>) &amp;&amp; &amp;ft !~# <span class="string">&#x27;commit&#x27;</span></span><br><span class="line">  \ |   <span class="keyword">exe</span> <span class="string">&quot;normal! g`\&quot;&quot;</span></span><br><span class="line">  \ | <span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">autocmd</span> InsertEnter * <span class="keyword">setlocal</span> spell</span><br><span class="line"><span class="keyword">autocmd</span> InsertLeave * <span class="keyword">setlocal</span> nospell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Define a hithlight group for extra white space</span></span><br><span class="line"><span class="keyword">highlight</span> ExtraWhitespace ctermbg=darkgreen guibg=lightgreen</span><br><span class="line"><span class="keyword">match</span> ExtraWhitespace /\s\+$/</span><br><span class="line"><span class="comment">&quot; Delete unused space keys at the end of a line.</span></span><br><span class="line"><span class="keyword">nnoremap</span> zz :%s/\s\+$// <span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Maximize gvim, require: sudo apt-get install wmctrl</span></span><br><span class="line"><span class="keyword">autocmd</span> GUIEnter * <span class="keyword">call</span> <span class="built_in">system</span>(<span class="string">&#x27;wmctrl -i -b add,maximized_vert,maximized_horz -r &#x27;</span>.<span class="variable">v:windowid</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;    __ __           __  ___               _</span></span><br><span class="line"><span class="comment">&quot;   / //_/__ __ __  /  |/  /__ ____  ___  (_)__  ___ ____</span></span><br><span class="line"><span class="comment">&quot;  / ,&lt; / -_) // / / /|_/ / _ `/ _ \/ _ \/ / _ \/ _ `(_-&lt;</span></span><br><span class="line"><span class="comment">&quot; /_/|_|\__/\_, / /_/  /_/\_,_/ .__/ .__/_/_//_/\_, /___/</span></span><br><span class="line"><span class="comment">&quot;          /___/             /_/  /_/          /___/</span></span><br><span class="line"><span class="comment">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">o</span> :<span class="keyword">only</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">e</span> :<span class="keyword">tabedit</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">w</span> :w!<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span>q :q!<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;C-w&gt;</span>s :<span class="keyword">sp</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;C-w&gt;</span>v :<span class="keyword">vs</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; <span class="doctag">TODO:</span> Remove this when ctrlsf support customized highlight group</span></span><br><span class="line"><span class="keyword">hi</span> ctrlsfSelectedLine guifg=#<span class="number">008787</span> guibg=NONE guisp=NONE <span class="keyword">gui</span>=bold ctermfg=<span class="number">30</span> ctermbg=NONE cterm=bold</span><br></pre></td></tr></table></figure>

<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><div id="dplayer0" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer0"),"theme":"#FADFA3","loop":true,"video":{"url":"/2021/02/01/modern_neovim/vim_demo.mp4"},"danmaku":{"id":"9E2E3368B56CDBB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo"}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script>

<h3 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h3><p>The above configures is mainly for the neovim, which is not fully tested in vim.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2021/01/30/pack_issue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/30/pack_issue/" class="post-title-link" itemprop="url">背包问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-30 23:01:34" itemprop="dateCreated datePublished" datetime="2021-01-30T23:01:34+08:00">2021-01-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-31 22:00:22" itemprop="dateModified" datetime="2021-01-31T22:00:22+08:00">2021-01-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>背包问题是动态规划的一种，其主要的分类和解法请参考</p>
<div class="pdfobject-container" data-target="/resources/pack_issue.pdf" data-height="500px"></div>

<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/tianyicui/pack/master/V2.pdf">https://raw.githubusercontent.com/tianyicui/pack/master/V2.pdf</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/13/simulated_annealing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/13/simulated_annealing/" class="post-title-link" itemprop="url">模拟退火</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-13 10:18:34" itemprop="dateCreated datePublished" datetime="2020-12-13T10:18:34+08:00">2020-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-14 23:35:57" itemprop="dateModified" datetime="2020-12-14T23:35:57+08:00">2020-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>模拟退火是一种通用概率算法，常用来在一定时间内寻找在一个很大搜寻空间中的近似最优解。和爬山算法相比，模拟退火算法以一定的概率接受不好的迭代，从而跳出局部最优。</p>
<p>下面我们尝试使用模拟退火算法来解决<a target="_blank" rel="noopener" href="https://leehengtong.com/2020/12/07/optimization_problem/">上篇文章</a>中的几个问题：</p>
<h2 id="问题1-离散空间优化问题"><a href="#问题1-离散空间优化问题" class="headerlink" title="问题1: 离散空间优化问题"></a>问题1: 离散空间优化问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neighbor</span>(<span class="params">last, T, t</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    returns a neighbor</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># compute used time</span></span><br><span class="line">    time = <span class="keyword">lambda</span> cur: <span class="built_in">sum</span>([cur[i] * t[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res = [i <span class="keyword">for</span> i <span class="keyword">in</span> last]</span><br><span class="line">        idx = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(last) - <span class="number">1</span>)</span><br><span class="line">        res[idx] = <span class="number">1</span> - res[idx]</span><br><span class="line">        <span class="keyword">if</span> time(res) &lt;= T:</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">T, M, t, m</span>):</span></span><br><span class="line">    <span class="comment"># compute the value got</span></span><br><span class="line">    value = <span class="keyword">lambda</span> cur: <span class="built_in">sum</span>([cur[i] * m[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M)])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># temperature setting</span></span><br><span class="line">    cur_tmp = <span class="number">100</span></span><br><span class="line">    tmp_fin = <span class="number">0.01</span></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    ans = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    val = value(ans)</span><br><span class="line">    <span class="keyword">while</span> cur_tmp &gt; tmp_fin:</span><br><span class="line">        <span class="comment"># get a neighbor</span></span><br><span class="line">        <span class="built_in">next</span> = neighbor(ans, T, t)</span><br><span class="line">        next_value = value(<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">        diff = next_value - val</span><br><span class="line">        r = random.random()</span><br><span class="line">        <span class="keyword">if</span> next_value &gt; val <span class="keyword">or</span> r &lt; math.exp(-<span class="built_in">abs</span>(diff) / cur_tmp):</span><br><span class="line">            ans = <span class="built_in">next</span></span><br><span class="line">            val = next_value</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update the temperature</span></span><br><span class="line">        cur_tmp = cur_tmp * <span class="number">0.999</span></span><br><span class="line"></span><br><span class="line">    print(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    T = <span class="number">70</span></span><br><span class="line">    M = <span class="number">3</span></span><br><span class="line">    t = [<span class="number">71</span>, <span class="number">69</span>, <span class="number">1</span>]</span><br><span class="line">    m = [<span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    solve(T, M, t, m)</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0, 1, 1]</span><br></pre></td></tr></table></figure>


<h2 id="问题2-连续空间多变量多约束非线性规划问题"><a href="#问题2-连续空间多变量多约束非线性规划问题" class="headerlink" title="问题2: 连续空间多变量多约束非线性规划问题"></a>问题2: 连续空间多变量多约束非线性规划问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constrain</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    check the constraint</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">6</span> <span class="keyword">or</span> i &lt; -<span class="number">6</span> <span class="keyword">or</span> i &gt; <span class="number">10</span> <span class="keyword">or</span> i &lt; -<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> -x[<span class="number">0</span>] * x[<span class="number">1</span>] &gt; <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">1.5</span> + x[<span class="number">0</span>] * x[<span class="number">1</span>] - x[<span class="number">0</span>] - x[<span class="number">1</span>] &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neighbor</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    returns a neighbor</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res = [i <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">        r1 = random.random()</span><br><span class="line"></span><br><span class="line">        idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> r1 &gt; <span class="number">0.5</span>:</span><br><span class="line">            idx = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        r2 = random.random()</span><br><span class="line">        sign = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> r2 &gt; <span class="number">0.5</span>:</span><br><span class="line">            sign = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        r3 = random.random()</span><br><span class="line">        res[idx] = res[idx] + sign * r3</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> constrain(res):</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    the target function</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> math.exp(</span><br><span class="line">        x[<span class="number">0</span>]) * (<span class="number">4</span> * x[<span class="number">0</span>]**<span class="number">2</span> + <span class="number">2</span> * x[<span class="number">1</span>]**<span class="number">2</span> + <span class="number">4</span> * x[<span class="number">0</span>] * x[<span class="number">1</span>] + <span class="number">2</span> * x[<span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    <span class="comment"># temperature setting</span></span><br><span class="line">    cur_tmp = <span class="number">100</span></span><br><span class="line">    tmp_fin = <span class="number">0.01</span></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    ans = [<span class="number">0</span>, <span class="number">5</span>]</span><br><span class="line">    val = func(ans)</span><br><span class="line">    <span class="keyword">while</span> cur_tmp &gt; tmp_fin:</span><br><span class="line">        <span class="comment"># get a neighbor</span></span><br><span class="line">        <span class="built_in">next</span> = neighbor(ans)</span><br><span class="line">        next_value = func(<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">        diff = next_value - val</span><br><span class="line">        r = random.random()</span><br><span class="line">        <span class="keyword">if</span> next_value &lt; val <span class="keyword">or</span> r &lt; math.exp(-<span class="built_in">abs</span>(diff) / cur_tmp):</span><br><span class="line">            ans = <span class="built_in">next</span></span><br><span class="line">            val = next_value</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update the temperature</span></span><br><span class="line">        cur_tmp = cur_tmp * <span class="number">0.999</span></span><br><span class="line"></span><br><span class="line">    print(ans)</span><br><span class="line">    print(func(ans))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[-5.976946429765198, 1.5103517825203914]</span><br><span class="line">0.2926414515330139</span><br></pre></td></tr></table></figure>
<p>用相同的初始值，模拟退火算法得到了更好的结果。</p>
<h2 id="问题3-连续空间最值问题"><a href="#问题3-连续空间最值问题" class="headerlink" title="问题3: 连续空间最值问题"></a>问题3: 连续空间最值问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    the target function</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">200</span> * math.exp(-<span class="number">0.05</span> * x[<span class="number">0</span>]) * math.sin(x[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constrain</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    check the constraint</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">0</span>] &gt;= -<span class="number">2</span> <span class="keyword">and</span> x[<span class="number">0</span>] &lt;= <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neighbor</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    returns a neighbor</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res = [i <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">        r1 = random.random()</span><br><span class="line">        sign = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> r1 &gt; <span class="number">0.5</span>:</span><br><span class="line">            sign = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        r2 = random.random()</span><br><span class="line">        res[<span class="number">0</span>] = res[<span class="number">0</span>] + sign * r2</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> constrain(res):</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    <span class="comment"># temperature setting</span></span><br><span class="line">    cur_tmp = <span class="number">100</span></span><br><span class="line">    tmp_fin = <span class="number">0.01</span></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    ans = [<span class="number">0</span>]</span><br><span class="line">    val = func(ans)</span><br><span class="line">    <span class="keyword">while</span> cur_tmp &gt; tmp_fin:</span><br><span class="line">        <span class="comment"># get a neighbor</span></span><br><span class="line">        <span class="built_in">next</span> = neighbor(ans)</span><br><span class="line">        next_value = func(<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">        diff = next_value - val</span><br><span class="line">        r = random.random()</span><br><span class="line">        <span class="keyword">if</span> next_value &lt; val <span class="keyword">or</span> r &lt; math.exp(-<span class="built_in">abs</span>(diff) / cur_tmp):</span><br><span class="line">            ans = <span class="built_in">next</span></span><br><span class="line">            val = next_value</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update the temperature</span></span><br><span class="line">        cur_tmp = cur_tmp * <span class="number">0.999</span></span><br><span class="line"></span><br><span class="line">    print(ans)</span><br><span class="line">    print(func(ans))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1.530673326410524]</span><br><span class="line">-185.11524120724246</span><br></pre></td></tr></table></figure>


<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB">https://zh.wikipedia.org/wiki/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Simulated_annealing">https://en.wikipedia.org/wiki/Simulated_annealing</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/12/hill_climbing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/12/hill_climbing/" class="post-title-link" itemprop="url">爬山算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-12 10:18:34 / 修改时间：17:04:16" itemprop="dateCreated datePublished" datetime="2020-12-12T10:18:34+08:00">2020-12-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>爬山算法是一种局部择优的方法，采用启发式方法，是对深度优先搜索的一种改进，它利用反馈信息帮助生成解的决策。</p>
<p>爬山算法一般存在以下问题：</p>
<ol>
<li>局部最大</li>
<li>高地：也称为平顶，搜索一旦到达高地，就无法确定搜索最佳方向，会产生随机走动，使得搜索效率降低。</li>
<li>山脊：搜索可能会在山脊的两面来回震荡，前进步伐很小。</li>
</ol>
<p>对于离散问题，我们从当前解出发，找到最佳的邻居进行下一步的迭代；对于连续空间的问题，我们对于每一个分量按照一定的步长进行探索，如果找到了更优的邻居，我们更新下一轮的步长为当前的最优步长；否则我们减小步长。下面我们尝试使用爬山算法来解决<a target="_blank" rel="noopener" href="https://leehengtong.com/2020/12/07/optimization_problem/">上篇文章</a>中的几个问题：</p>
<h2 id="问题1-离散空间优化问题"><a href="#问题1-离散空间优化问题" class="headerlink" title="问题1: 离散空间优化问题"></a>问题1: 离散空间优化问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neighbor</span>(<span class="params">last</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    returns all neighbors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line">        cur = []</span><br><span class="line">        <span class="keyword">for</span> j, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(last):</span><br><span class="line">            <span class="keyword">if</span> j == i:</span><br><span class="line">                n = <span class="number">1</span> - n</span><br><span class="line">            cur.append(n)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">yield</span> cur</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">T, M, t, m</span>):</span></span><br><span class="line">    <span class="comment"># compute used time</span></span><br><span class="line">    time = <span class="keyword">lambda</span> cur: <span class="built_in">sum</span>([cur[i] * t[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M)])</span><br><span class="line">    <span class="comment"># compute the value got</span></span><br><span class="line">    value = <span class="keyword">lambda</span> cur: <span class="built_in">sum</span>([cur[i] * m[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M)])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    ans = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    update = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span> update:</span><br><span class="line">        update = <span class="literal">False</span></span><br><span class="line">        ans_time = time(ans)</span><br><span class="line">        ans_value = value(ans)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> cur <span class="keyword">in</span> neighbor(ans):</span><br><span class="line">            cur_time = time(cur)</span><br><span class="line">            cur_value = value(cur)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> cur_time &lt;= T <span class="keyword">and</span> cur_value &gt; ans_value:</span><br><span class="line">                ans = cur</span><br><span class="line">                update = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    print(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    T = <span class="number">70</span></span><br><span class="line">    M = <span class="number">3</span></span><br><span class="line">    t = [<span class="number">71</span>, <span class="number">69</span>, <span class="number">1</span>]</span><br><span class="line">    m = [<span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    solve(T, M, t, m)</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0, 1, 1]</span><br></pre></td></tr></table></figure>


<h2 id="问题2-连续空间多变量多约束非线性规划问题"><a href="#问题2-连续空间多变量多约束非线性规划问题" class="headerlink" title="问题2: 连续空间多变量多约束非线性规划问题"></a>问题2: 连续空间多变量多约束非线性规划问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    the target function</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> math.exp(</span><br><span class="line">        x[<span class="number">0</span>]) * (<span class="number">4</span> * x[<span class="number">0</span>]**<span class="number">2</span> + <span class="number">2</span> * x[<span class="number">1</span>]**<span class="number">2</span> + <span class="number">4</span> * x[<span class="number">0</span>] * x[<span class="number">1</span>] + <span class="number">2</span> * x[<span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constrain</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    check the constraint</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">6</span> <span class="keyword">or</span> i &lt; -<span class="number">6</span> <span class="keyword">or</span> i &gt; <span class="number">10</span> <span class="keyword">or</span> i &lt; -<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> -x[<span class="number">0</span>] * x[<span class="number">1</span>] &gt; <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">1.5</span> + x[<span class="number">0</span>] * x[<span class="number">1</span>] - x[<span class="number">0</span>] - x[<span class="number">1</span>] &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    step = [<span class="number">0.1</span>, <span class="number">0.1</span>]</span><br><span class="line">    accel = <span class="number">1.2</span></span><br><span class="line">    candi = [-accel, -<span class="number">1</span> / accel, <span class="number">1</span> / accel, accel]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    cur_ans = [<span class="number">0</span>, <span class="number">5</span>]</span><br><span class="line">    best_val = func(cur_ans)</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = k + <span class="number">1</span></span><br><span class="line">        before_val = best_val</span><br><span class="line">        <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(cur_ans):</span><br><span class="line">            before_ans = copy.deepcopy(cur_ans)</span><br><span class="line">            best_step = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> candi:</span><br><span class="line">                cur_step = step[i] * c</span><br><span class="line">                cur_ans[i] = before_ans[i] + cur_step</span><br><span class="line">                <span class="keyword">if</span> constrain(cur_ans):</span><br><span class="line">                    cur_val = func(cur_ans)</span><br><span class="line">                    <span class="keyword">if</span> cur_val &lt; best_val:</span><br><span class="line">                        print(</span><br><span class="line">                            <span class="string">&quot;update &#123;0&#125;th by step &#123;1&#125;, current ans: &#123;2&#125;, current val: &#123;3&#125;)&quot;</span></span><br><span class="line">                            .<span class="built_in">format</span>(i, cur_step, cur_ans, cur_val))</span><br><span class="line">                        best_val = cur_val</span><br><span class="line">                        best_step = cur_step</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> best_step == <span class="number">0</span>:</span><br><span class="line">                step[i] = step[i] / accel</span><br><span class="line">                cur_ans[i] = before_ans[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                step[i] = best_step</span><br><span class="line">                cur_ans[i] = before_ans[i] + best_step</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;iteration &#123;0&#125;: &#123;1&#125;, &#123;2&#125;&quot;</span>.<span class="built_in">format</span>(k, cur_ans, best_val))</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(best_val - before_val) &lt; <span class="number">1e-16</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    print(cur_ans)</span><br><span class="line">    print(func(cur_ans))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">update 0th by step -0.12, current ans: [-0.12, 5], current val: 52.02462420878034)</span><br><span class="line">update 1th by step -0.12, current ans: [-0.12, 4.88], current val: 49.759784181579406)</span><br><span class="line">iteration 1: [-0.12, 4.88], 49.759784181579406</span><br><span class="line">update 0th by step -0.1, current ans: [-0.22, 4.88], current val: 43.56714050378704)</span><br><span class="line">update 0th by step -0.144, current ans: [-0.264, 4.88], current val: 41.09756946514502)</span><br><span class="line">update 1th by step -0.1, current ans: [-0.264, 4.78], current val: 39.541347884384685)</span><br><span class="line">update 1th by step -0.144, current ans: [-0.264, 4.736], current val: 38.86634214954465)</span><br><span class="line">iteration 2: [-0.264, 4.736], 38.86634214954465</span><br><span class="line">update 0th by step -0.12, current ans: [-0.384, 4.736], current val: 33.13480982120382)</span><br><span class="line">update 0th by step -0.17279999999999998, current ans: [-0.43679999999999997, 4.736], current val: 30.896422546501622)</span><br><span class="line">update 1th by step -0.12, current ans: [-0.43679999999999997, 4.616], current val: 29.426662476165006)</span><br><span class="line">update 1th by step -0.17279999999999998, current ans: [-0.43679999999999997, 4.5632], current val: 28.79175788291818)</span><br><span class="line">iteration 3: [-0.43679999999999997, 4.5632], 28.79175788291818</span><br><span class="line">update 0th by step -0.144, current ans: [-0.5808, 4.5632], current val: 23.787883625501976)</span><br><span class="line">update 0th by step -0.20735999999999996, current ans: [-0.64416, 4.5632], current val: 21.883178378702226)</span><br><span class="line">update 1th by step -0.144, current ans: [-0.64416, 4.4192], current val: 20.56837447029764)</span><br><span class="line">update 1th by step -0.20735999999999996, current ans: [-0.64416, 4.355840000000001], current val: 20.00365871483697)</span><br><span class="line">iteration 4: [-0.64416, 4.355840000000001], 20.00365871483697</span><br><span class="line">update 0th by step -0.17279999999999998, current ans: [-0.8169599999999999, 4.355840000000001], current val: 15.945283197922732)</span><br><span class="line">update 0th by step -0.24883199999999994, current ans: [-0.8929919999999999, 4.355840000000001], current val: 14.448411201985614)</span><br><span class="line">update 1th by step -0.17279999999999998, current ans: [-0.8929919999999999, 4.183040000000001], current val: 13.351387037399203)</span><br><span class="line">update 1th by step -0.24883199999999994, current ans: [-0.8929919999999999, 4.107008], current val: 12.884188535334253)</span><br><span class="line">iteration 5: [-0.8929919999999999, 4.107008], 12.884188535334253</span><br><span class="line">update 0th by step -0.20735999999999996, current ans: [-1.1003519999999998, 4.107008], current val: 9.887958052713891)</span><br><span class="line">update 0th by step -0.29859839999999993, current ans: [-1.1915904, 4.107008], current val: 8.824528435241017)</span><br><span class="line">update 1th by step -0.20735999999999996, current ans: [-1.1915904, 3.8996480000000004], current val: 7.990194786653624)</span><br><span class="line">update 1th by step -0.29859839999999993, current ans: [-1.1915904, 3.8084096000000005], current val: 7.639637828810663)</span><br><span class="line">iteration 6: [-1.1915904, 3.8084096000000005], 7.639637828810663</span><br><span class="line">update 0th by step -0.24883199999999994, current ans: [-1.4404223999999999, 3.8084096000000005], current val: 5.679407582979268)</span><br><span class="line">update 0th by step -0.3583180799999999, current ans: [-1.5499084799999998, 3.8084096000000005], current val: 5.0143729160083135)</span><br><span class="line">update 1th by step -0.24883199999999994, current ans: [-1.5499084799999998, 3.559577600000001], current val: 4.457854774352143)</span><br><span class="line">update 1th by step -0.3583180799999999, current ans: [-1.5499084799999998, 3.4500915200000004], current val: 4.229641649646535)</span><br><span class="line">iteration 7: [-1.5499084799999998, 3.4500915200000004], 4.229641649646535</span><br><span class="line">update 0th by step -0.29859839999999993, current ans: [-1.8485068799999997, 3.4500915200000004], current val: 3.128071004768359)</span><br><span class="line">update 0th by step -0.4299816959999999, current ans: [-1.9798901759999996, 3.4500915200000004], current val: 2.7704007740632144)</span><br><span class="line">update 1th by step -0.29859839999999993, current ans: [-1.9798901759999996, 3.1514931200000005], current val: 2.470084617885889)</span><br><span class="line">update 1th by step -0.4299816959999999, current ans: [-1.9798901759999996, 3.0201098240000004], current val: 2.3535469510854665)</span><br><span class="line">iteration 8: [-1.9798901759999996, 3.0201098240000004], 2.3535469510854665</span><br><span class="line">update 0th by step -0.3583180799999999, current ans: [-2.3382082559999997, 3.0201098240000004], current val: 1.8243045861337608)</span><br><span class="line">update 0th by step -0.5159780351999999, current ans: [-2.4958682111999995, 3.0201098240000004], current val: 1.6525025525118668)</span><br><span class="line">update 1th by step -0.3583180799999999, current ans: [-2.4958682111999995, 2.6617917440000003], current val: 1.5526668064303875)</span><br><span class="line">update 1th by step -0.5159780351999999, current ans: [-2.4958682111999995, 2.5041317888000005], current val: 1.5221494499076038)</span><br><span class="line">iteration 9: [-2.4958682111999995, 2.5041317888000005], 1.5221494499076038</span><br><span class="line">update 0th by step -0.4299816959999999, current ans: [-2.9258499071999995, 2.5041317888000005], current val: 1.2592527050521631)</span><br><span class="line">update 0th by step -0.6191736422399998, current ans: [-3.1150418534399993, 2.5041317888000005], current val: 1.160966703528361)</span><br><span class="line">iteration 10: [-3.1150418534399993, 2.5041317888000005], 1.160966703528361</span><br><span class="line">update 0th by step -0.5159780351999999, current ans: [-3.631019888639999, 2.5041317888000005], current val: 0.9249119591204455)</span><br><span class="line">update 0th by step -0.7430083706879997, current ans: [-3.8580502241279993, 2.5041317888000005], current val: 0.8326186761463709)</span><br><span class="line">iteration 11: [-3.8580502241279993, 2.5041317888000005], 0.8326186761463709</span><br><span class="line">iteration 12: [-3.8580502241279993, 2.5041317888000005], 0.8326186761463709</span><br><span class="line">[-3.8580502241279993, 2.5041317888000005]</span><br><span class="line">0.8326186761463709</span><br></pre></td></tr></table></figure>




<h2 id="问题3-连续空间最值问题"><a href="#问题3-连续空间最值问题" class="headerlink" title="问题3: 连续空间最值问题"></a>问题3: 连续空间最值问题</h2><p>我们使用以下程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    the target function</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">200</span> * math.exp(-<span class="number">0.05</span> * x[<span class="number">0</span>]) * math.sin(x[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constrain</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    check the constraint</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">0</span>] &gt;= -<span class="number">2</span> <span class="keyword">and</span> x[<span class="number">0</span>] &lt;= <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    step = [<span class="number">0.1</span>]</span><br><span class="line">    accel = <span class="number">1.2</span></span><br><span class="line">    candi = [-accel, -<span class="number">1</span> / accel, <span class="number">1</span> / accel, accel]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># valid init solution</span></span><br><span class="line">    cur_ans = [<span class="number">0</span>]</span><br><span class="line">    best_val = func(cur_ans)</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = k + <span class="number">1</span></span><br><span class="line">        before_val = best_val</span><br><span class="line">        <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(cur_ans):</span><br><span class="line">            before_ans = copy.deepcopy(cur_ans)</span><br><span class="line">            best_step = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> candi:</span><br><span class="line">                cur_step = step[i] * c</span><br><span class="line">                cur_ans[i] = before_ans[i] + cur_step</span><br><span class="line">                <span class="keyword">if</span> constrain(cur_ans):</span><br><span class="line">                    cur_val = func(cur_ans)</span><br><span class="line">                    <span class="keyword">if</span> cur_val &lt; best_val:</span><br><span class="line">                        print(</span><br><span class="line">                            <span class="string">&quot;update &#123;0&#125;th by step &#123;1&#125;, current ans: &#123;2&#125;, current val: &#123;3&#125;)&quot;</span></span><br><span class="line">                            .<span class="built_in">format</span>(i, cur_step, cur_ans, cur_val))</span><br><span class="line">                        best_val = cur_val</span><br><span class="line">                        best_step = cur_step</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> best_step == <span class="number">0</span>:</span><br><span class="line">                step[i] = step[i] / accel</span><br><span class="line">                cur_ans[i] = before_ans[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                step[i] = best_step</span><br><span class="line">                cur_ans[i] = before_ans[i] + best_step</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;iteration &#123;0&#125;: &#123;1&#125;, &#123;2&#125;&quot;</span>.<span class="built_in">format</span>(k, cur_ans, best_val))</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(best_val - before_val) &lt; <span class="number">1e-16</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    print(cur_ans)</span><br><span class="line">    print(func(cur_ans))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">update 0th by step 0.08333333333333334, current ans: [0.08333333333333334], current val: -16.578163451266125)</span><br><span class="line">update 0th by step 0.12, current ans: [0.12], current val: -23.799216912346857)</span><br><span class="line">iteration 1: [0.12], -23.799216912346857</span><br><span class="line">update 0th by step 0.1, current ans: [0.22], current val: -43.16845036828165)</span><br><span class="line">update 0th by step 0.144, current ans: [0.264], current val: -51.5044434420067)</span><br><span class="line">iteration 2: [0.264], -51.5044434420067</span><br><span class="line">update 0th by step 0.12, current ans: [0.384], current val: -73.50156515472206)</span><br><span class="line">update 0th by step 0.17279999999999998, current ans: [0.43679999999999997], current val: -82.78060135028912)</span><br><span class="line">iteration 3: [0.43679999999999997], -82.78060135028912</span><br><span class="line">update 0th by step 0.144, current ans: [0.5808], current val: -106.59760552432024)</span><br><span class="line">update 0th by step 0.20735999999999996, current ans: [0.64416], current val: -116.29867444926786)</span><br><span class="line">iteration 4: [0.64416], -116.29867444926786</span><br><span class="line">update 0th by step 0.17279999999999998, current ans: [0.8169599999999999], current val: -139.97751214953558)</span><br><span class="line">update 0th by step 0.24883199999999994, current ans: [0.8929919999999999], current val: -148.98732425593082)</span><br><span class="line">iteration 5: [0.8929919999999999], -148.98732425593082</span><br><span class="line">update 0th by step 0.20735999999999996, current ans: [1.1003519999999998], current val: -168.73015014835786)</span><br><span class="line">update 0th by step 0.29859839999999993, current ans: [1.1915904], current val: -175.04569315355005)</span><br><span class="line">iteration 6: [1.1915904], -175.04569315355005</span><br><span class="line">update 0th by step 0.24883199999999994, current ans: [1.4404223999999999], current val: -184.52286412601495)</span><br><span class="line">update 0th by step 0.3583180799999999, current ans: [1.5499084799999998], current val: -185.04587653587126)</span><br><span class="line">iteration 7: [1.5499084799999998], -185.04587653587126</span><br><span class="line">iteration 8: [1.5499084799999998], -185.04587653587126</span><br><span class="line">[1.5499084799999998]</span><br><span class="line">-185.04587653587126</span><br></pre></td></tr></table></figure>


<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a target="_blank" rel="noopener" href="https://oi-wiki.org/misc/hill-climbing/">https://oi-wiki.org/misc/hill-climbing/</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hill_climbing">https://en.wikipedia.org/wiki/Hill_climbing</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/07/optimization_problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/07/optimization_problem/" class="post-title-link" itemprop="url">优化问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-07 22:18:34" itemprop="dateCreated datePublished" datetime="2020-12-07T22:18:34+08:00">2020-12-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-30 23:06:52" itemprop="dateModified" datetime="2021-01-30T23:06:52+08:00">2021-01-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我们工作生活中的很多问题都是优化问题。在本文中，我们给出几个典型的例子，并尝试使用现有的求解器进行求解，作为参照。在后续文章中，我们将介绍一些启发式算法，并对本文中的问题进行求解。</p>
<h2 id="问题1-离散空间优化问题"><a href="#问题1-离散空间优化问题" class="headerlink" title="问题1: 离散空间优化问题"></a>问题1: 离散空间优化问题</h2><h3 id="luogu-P1048-采药"><a href="#luogu-P1048-采药" class="headerlink" title="luogu P1048 采药"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1048">luogu P1048 采药</a></h3><blockquote>
<h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><p>辰辰是个天资聪颖的孩子，他的梦想是成为世界上最伟大的医师。为此，他想拜附近最有威望的医师为师。医师为了判断他的资质，给他出了一个难题。医师把他带到一个到处都是草药的山洞里对他说：“孩子，这个山洞里有一些不同的草药，采每一株都需要一些时间，每一株也有它自身的价值。我会给你一段时间，在这段时间里，你可以采到一些草药。如果你是一个聪明的孩子，你应该可以让采到的草药的总价值最大。”</p>
<p>如果你是辰辰，你能完成这个任务吗？</p>
<h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h4><p>第一行有 $2$ 个整数 $T$（$1 \le T \le 1000, \ 1 \le T \le 000$）和 $M$（$1 \le M \le 100, \ 1 \le M \le 100$），用一个空格隔开，$T$ 代表总共能够用来采药的时间，$M$ 代表山洞里的草药的数目。</p>
<p>接下来的 $M$ 行每行包括两个在 $1$ 到 $100$ 之间（包括 $1$ 和 $100$）的整数，分别表示采摘某株草药的时间和这株草药的价值。</p>
<h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h4><p>输出在规定的时间内可以采到的草药的最大总价值。</p>
<h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例"></a>输入样例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">70 3</span><br><span class="line">71 100</span><br><span class="line">69 1</span><br><span class="line">1 2</span><br></pre></td></tr></table></figure>

<h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例"></a>输出样例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><ul>
<li>对于 30% 的数据，$M \le 10$</li>
<li>对于全部的数据，$M \le 100$</li>
</ul>
</blockquote>
<p>这是一个典型的0/1背包问题，我们用$x_{i}$表示第$i$种草药采集与否，用$t_{i}$表示采集第$i$种草药所需要的时间，用$m_{i}$表示第$i$种草药的价值，我们的目标是在有限的时间$T$内使采集到的草药价值最大，那么我们就会得到如下的形式化表述:<br>$$\begin{equation}\label{eq1}<br>\begin{aligned}<br>max \ \sum_{i = 1}^{M} x_{i}m_{i} &amp;           \\<br>x_{i}(x_{i}-1) = 0, i \in [1, M]               \\<br>0 \le \sum_{i = 1}^{M}{x_{i}t_{i} \le T}         \\<br>\end{aligned}<br>\end{equation}$$</p>
<p>上面公式中的$x_{i}(x_{i-1})=0$是为了确保$x_{i}$只能取0和1。针对这个问题，我们使用如下的程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> SR1</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> NonlinearConstraint</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> LinearConstraint</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rosen</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;</span></span><br><span class="line">        m = [<span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>]  <span class="comment"># values</span></span><br><span class="line">        total = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">            total = x[i] * m[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> -total</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the constraints</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_f</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> [i * (i - <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_J</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> [[<span class="number">2</span> * x[<span class="number">0</span>] - <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">2</span> * x[<span class="number">1</span>] - <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span> * x[<span class="number">2</span>] - <span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_H</span>(<span class="params">x, v</span>):</span></span><br><span class="line">        <span class="keyword">return</span> v[<span class="number">0</span>] * np.array(</span><br><span class="line">            [[<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]]) + v[<span class="number">1</span>] * np.array([</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">            ]) + v[<span class="number">2</span>] * np.array([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>]])</span><br><span class="line"></span><br><span class="line">    nonlinear_constraint = NonlinearConstraint(cons_f, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                                               jac=cons_J,</span><br><span class="line">                                               hess=cons_H)</span><br><span class="line"></span><br><span class="line">    linear_constraint = LinearConstraint([[<span class="number">71</span>, <span class="number">69</span>, <span class="number">1</span>]], [<span class="number">0</span>], [<span class="number">70</span>])</span><br><span class="line"></span><br><span class="line">    x0 = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    res = minimize(rosen,</span><br><span class="line">                   x0,</span><br><span class="line">                   method=<span class="string">&#x27;trust-constr&#x27;</span>,</span><br><span class="line">                   jac=<span class="string">&quot;2-point&quot;</span>,</span><br><span class="line">                   hess=SR1(),</span><br><span class="line">                   constraints=[nonlinear_constraint, linear_constraint],</span><br><span class="line">                   options=&#123;<span class="string">&#x27;verbose&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line">    print(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">barrier_parameter: 2.048000000000001e-09</span><br><span class="line">barrier_tolerance: 2.048000000000001e-09</span><br><span class="line">         cg_niter: 0</span><br><span class="line">     cg_stop_cond: 1</span><br><span class="line">           constr: [array([-0.0073379 ,  0.00693036,  0.0001018 ]), array([70.00010182])]</span><br><span class="line">      constr_nfev: [106, 0]</span><br><span class="line">      constr_nhev: [82, 0]</span><br><span class="line">      constr_njev: [79, 0]</span><br><span class="line">   constr_penalty: 1.0</span><br><span class="line"> constr_violation: 0.0073378956828978265</span><br><span class="line">   execution_time: 0.149078369140625</span><br><span class="line">              fun: 0.00020358301622653028</span><br><span class="line">             grad: array([ 0., -0., -2.])</span><br><span class="line">              jac: [array([[ 0.98521491,  0.        ,  0.        ],</span><br><span class="line">      [ 0.        , -1.01376596,  0.        ],</span><br><span class="line">      [ 0.        ,  0.        , -1.00020358]]), array([[71, 69,  1]])]</span><br><span class="line">  lagrangian_grad: array([-7.48012763e-15, -1.15411153e-14, -2.22470154e-15])</span><br><span class="line">          message: &#39;&#96;xtol&#96; termination condition is satisfied.&#39;</span><br><span class="line">           method: &#39;tr_interior_point&#39;</span><br><span class="line">             nfev: 424</span><br><span class="line">             nhev: 0</span><br><span class="line">              nit: 188</span><br><span class="line">            niter: 188</span><br><span class="line">             njev: 106</span><br><span class="line">       optimality: 1.1541115285673698e-14</span><br><span class="line">           status: 2</span><br><span class="line">          success: True</span><br><span class="line">        tr_radius: 1.0000000000000005e-09</span><br><span class="line">                v: [array([-0.01465935,  0.01384519, -1.99938954]), array([0.00020342])]</span><br><span class="line">                x: array([ 9.92607455e-01, -6.88298061e-03, -1.01791508e-04])</span><br></pre></td></tr></table></figure>
<p>可以看到使用这个求解器并没有得到正确的结果，上面提到的二值约束对这个求解器不是很友好，求解的结果也不满足约束条件。</p>
<h2 id="问题2-连续空间多变量多约束非线性规划问题"><a href="#问题2-连续空间多变量多约束非线性规划问题" class="headerlink" title="问题2: 连续空间多变量多约束非线性规划问题"></a>问题2: 连续空间多变量多约束非线性规划问题</h2><p>$$min \ f(x) = e^{x_{1}}(4x_{1}^{2}+2x_{2}^{2}+4x_{1}x_{2}+2x_{2}+1)$$</p>
<p>$$\begin{equation}\label{eq2}<br>\begin{aligned}<br>1.5 + x_{1}x_{2} -x_{1} - x_{2} &amp;\leq 0          \\<br>-x_{1}x_{2} &amp;\leq 10                           \\<br>-10 \leq x_{1} &amp;\leq 10                       \\<br>-6  \leq x_{2} &amp;\leq 6                        \\<br>\end{aligned}<br>\end{equation}$$</p>
<p>我们先来看一下函数图像，基本上$x, y$越小，函数的值越小。<br><img src="/2020/12/07/optimization_problem/issue2.png" alt="Fig1. 函数图像"><span class="image-caption">Fig1. 函数图像</span></p>
<p>我们使用下面的程序对这个问题进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> Bounds</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> SR1</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> NonlinearConstraint</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> np.exp(x) * (<span class="number">4</span> * x * x + <span class="number">2</span> * y * y + <span class="number">4</span> * x * y + <span class="number">2</span> * y + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    x = np.linspace(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">    y = np.linspace(-<span class="number">6</span>, <span class="number">6</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    X, Y = np.meshgrid(x, y)</span><br><span class="line">    Z = f(X, Y)</span><br><span class="line"></span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    ax = plt.axes(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">    ax.plot_surface(X, Y, Z, cmap=<span class="string">&#x27;rainbow&#x27;</span>)</span><br><span class="line">    ax.set_xlabel(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">    ax.set_zlabel(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    plt.show()</span><br><span class="line">    plt.tight_layout()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rosen</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> math.exp(x[<span class="number">0</span>]) * (<span class="number">4</span> * x[<span class="number">0</span>] * x[<span class="number">0</span>] + <span class="number">2</span> * x[<span class="number">1</span>] * x[<span class="number">1</span>] +</span><br><span class="line">                                 <span class="number">4</span> * x[<span class="number">0</span>] * x[<span class="number">1</span>] + <span class="number">2</span> * x[<span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the bound</span></span><br><span class="line">    bounds = Bounds([-<span class="number">10.0</span>, -<span class="number">6.0</span>], [<span class="number">10.0</span>, <span class="number">6.0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the constraints</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_f</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="number">1.5</span> + x[<span class="number">0</span>] * x[<span class="number">1</span>] - x[<span class="number">0</span>] - x[<span class="number">1</span>], -x[<span class="number">0</span>] * x[<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_J</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> [[x[<span class="number">1</span>] - <span class="number">1</span>, x[<span class="number">0</span>] - <span class="number">1</span>], [-<span class="number">1</span>, -<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cons_H</span>(<span class="params">x, v</span>):</span></span><br><span class="line">        <span class="keyword">return</span> v[<span class="number">0</span>] * np.array([[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>]]) + v[<span class="number">1</span>] * np.array([[<span class="number">0</span>, -<span class="number">1</span>],</span><br><span class="line">                                                                    [-<span class="number">1</span>, <span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">    nonlinear_constraint = NonlinearConstraint(cons_f, [-np.inf, -np.inf],</span><br><span class="line">                                               [<span class="number">0</span>, <span class="number">10</span>],</span><br><span class="line">                                               jac=cons_J,</span><br><span class="line">                                               hess=cons_H)</span><br><span class="line"></span><br><span class="line">    x0 = [<span class="number">0.0</span>, <span class="number">5.0</span>]</span><br><span class="line">    res = minimize(rosen,</span><br><span class="line">                   x0,</span><br><span class="line">                   method=<span class="string">&#x27;trust-constr&#x27;</span>,</span><br><span class="line">                   jac=<span class="string">&quot;2-point&quot;</span>,</span><br><span class="line">                   hess=SR1(),</span><br><span class="line">                   constraints=[nonlinear_constraint],</span><br><span class="line">                   options=&#123;<span class="string">&#x27;verbose&#x27;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">                   bounds=bounds)</span><br><span class="line">    print(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plot()</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">barrier_parameter: 2.048000000000001e-09</span><br><span class="line">barrier_tolerance: 2.048000000000001e-09</span><br><span class="line">         cg_niter: 529</span><br><span class="line">     cg_stop_cond: 2</span><br><span class="line">           constr: [array([-1.82051237,  9.73411463]), array([-7.68091424,  1.26731198])]</span><br><span class="line">      constr_nfev: [564, 0]</span><br><span class="line">      constr_nhev: [289, 0]</span><br><span class="line">      constr_njev: [288, 0]</span><br><span class="line">   constr_penalty: 1.0</span><br><span class="line"> constr_violation: 0.0</span><br><span class="line">   execution_time: 0.5691990852355957</span><br><span class="line">              fun: 0.0940626469286803</span><br><span class="line">             grad: array([ 0.06804119, -0.01091776])</span><br><span class="line">              jac: [array([[ 0.26731198, -8.68091424],</span><br><span class="line">      [-1.        , -1.        ]]), array([[1., 0.],</span><br><span class="line">      [0., 1.]])]</span><br><span class="line">  lagrangian_grad: array([ 0.00747274, -0.00263313])</span><br><span class="line">          message: &#39;&#96;xtol&#96; termination condition is satisfied.&#39;</span><br><span class="line">           method: &#39;tr_interior_point&#39;</span><br><span class="line">             nfev: 1692</span><br><span class="line">             nhev: 0</span><br><span class="line">              nit: 536</span><br><span class="line">            niter: 536</span><br><span class="line">             njev: 564</span><br><span class="line">       optimality: 0.007472736269283172</span><br><span class="line">           status: 2</span><br><span class="line">          success: True</span><br><span class="line">        tr_radius: 6.8134308785272305e-09</span><br><span class="line">                v: [array([-0.00751795,  0.05714546]), array([-0.00141336,  0.00016742])]</span><br><span class="line">                x: array([-7.68091424,  1.26731198])</span><br></pre></td></tr></table></figure>

<p>初步验证一下，这个结果应该是符合预期的。</p>
<h2 id="问题3-连续空间最值问题"><a href="#问题3-连续空间最值问题" class="headerlink" title="问题3: 连续空间最值问题"></a>问题3: 连续空间最值问题</h2><p>$$\begin{equation}\label{eq3}<br>\begin{aligned}<br>max \ f(x) = 200&amp;e^{-0.05x}sin(x)            \\<br>-2 \le &amp;x \le 2<br>\end{aligned}<br>\end{equation}$$</p>
<p>我们先来看一下函数图像，这个结果比较明显.<br><img src="/2020/12/07/optimization_problem/issue3.png" alt="Fig2. 函数图像"><span class="image-caption">Fig2. 函数图像</span></p>
<p>针对这个问题，我们使用如下的程序进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> Bounds</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> SR1</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rosen</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">200</span> * math.exp(-<span class="number">0.05</span> * x) * math.sin(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot</span>():</span></span><br><span class="line">    x = np.linspace(-<span class="number">2</span>, <span class="number">2</span>, <span class="number">100</span>)</span><br><span class="line">    y = [rosen(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">    plt.plot(x, y, color=<span class="string">&quot;r&quot;</span>, linestyle=<span class="string">&quot;-&quot;</span>, linewidth=<span class="number">1</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>():</span></span><br><span class="line">    bounds = Bounds([-<span class="number">2.0</span>], [<span class="number">2.0</span>])</span><br><span class="line">    x0 = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    res = minimize(rosen,</span><br><span class="line">                   x0,</span><br><span class="line">                   method=<span class="string">&#x27;trust-constr&#x27;</span>,</span><br><span class="line">                   jac=<span class="string">&quot;2-point&quot;</span>,</span><br><span class="line">                   hess=SR1(),</span><br><span class="line">                   options=&#123;<span class="string">&#x27;verbose&#x27;</span>: <span class="number">1</span>&#125;,</span><br><span class="line">                   bounds=bounds)</span><br><span class="line">    print(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plot()</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">barrier_parameter: 3.200000000000001e-05</span><br><span class="line">barrier_tolerance: 3.200000000000001e-05</span><br><span class="line">         cg_niter: 9</span><br><span class="line">     cg_stop_cond: 1</span><br><span class="line">           constr: [array([1.52083761])]</span><br><span class="line">      constr_nfev: [0]</span><br><span class="line">      constr_nhev: [0]</span><br><span class="line">      constr_njev: [0]</span><br><span class="line">   constr_penalty: 1.0</span><br><span class="line"> constr_violation: 0.0</span><br><span class="line">   execution_time: 0.08674049377441406</span><br><span class="line">              fun: -185.1242145731396</span><br><span class="line">             grad: array([-5.76906021e-05])</span><br><span class="line">              jac: [&lt;1x1 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;</span><br><span class="line">       with 1 stored elements in Compressed Sparse Row format&gt;]</span><br><span class="line">  lagrangian_grad: array([7.09417522e-10])</span><br><span class="line">          message: &#39;&#96;gtol&#96; termination condition is satisfied.&#39;</span><br><span class="line">           method: &#39;tr_interior_point&#39;</span><br><span class="line">             nfev: 20</span><br><span class="line">             nhev: 0</span><br><span class="line">              nit: 15</span><br><span class="line">            niter: 15</span><br><span class="line">             njev: 10</span><br><span class="line">       optimality: 7.0941752157368e-10</span><br><span class="line">           status: 1</span><br><span class="line">          success: True</span><br><span class="line">        tr_radius: 24107.414128166944</span><br><span class="line">                v: [array([5.76913115e-05])]</span><br><span class="line">                x: array([1.52083761])</span><br></pre></td></tr></table></figure>
<p>根据图像得知，这个求解结果是正确的。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1099730">https://cloud.tencent.com/developer/article/1099730</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html">https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/06/convex_optimization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/06/convex_optimization/" class="post-title-link" itemprop="url">凸优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-06 17:24:34" itemprop="dateCreated datePublished" datetime="2020-12-06T17:24:34+08:00">2020-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-11 20:52:42" itemprop="dateModified" datetime="2020-12-11T20:52:42+08:00">2020-12-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>$$ min \ f_{0}(x) $$<br>$$ subject \ to \ f_{i}(x) \leqslant b_{i} \ i=1,…,m $$</p>
<ul>
<li>目标函数和限制函数都是凸的，即<br>$$ f_{i}(\alpha x + \beta y) \leqslant \alpha f_{i}(x) + \beta f_{i}(y) \ \alpha + \beta = 1, \alpha \geq 0, \beta \geq 0 $$</li>
<li>最小二乘问题和线性规划问题都是凸优化问题的特例</li>
</ul>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ol>
<li>没有解析解</li>
<li>但是有可靠和高效的求解算法</li>
<li>计算时间复杂度大体上和$max(n^{3}, n^{2}m, F)$成正比，其中$F$是计算$f_{i}$和它的一阶导，二阶导的开销</li>
</ol>
<h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><ol>
<li>每一个局部最优解都是全局最优解</li>
<li>最优解集合是凸的</li>
<li>如果目标函数是严格凸的，那么这个优化问题就最多只有一个最优解</li>
</ol>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ol>
<li>一般不容易分析出问题的凸优化形式</li>
<li>需要很多技巧才能将问题转换成凸优化问题</li>
<li>会对很多问题能够凸优化求解感到惊奇</li>
</ol>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li>Standford Boyd, Convex Optimization course, <a target="_blank" rel="noopener" href="https://web.stanford.edu/~boyd/cvxbook/">https://web.stanford.edu/~boyd/cvxbook/</a></li>
<li>Standford Boyd, Convex Optimization <a href="/2020/12/06/convex_optimization/bv_cvxslides.pdf">slides</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/03/random_algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/03/random_algorithm/" class="post-title-link" itemprop="url">随机算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-03 09:08:34" itemprop="dateCreated datePublished" datetime="2020-12-03T09:08:34+08:00">2020-12-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-05 22:56:37" itemprop="dateModified" datetime="2020-12-05T22:56:37+08:00">2020-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="问题1-拒绝采样"><a href="#问题1-拒绝采样" class="headerlink" title="问题1: 拒绝采样"></a>问题1: 拒绝采样</h2><h3 id="leetcode-470-Implement-Rand10-Using-Rand7"><a href="#leetcode-470-Implement-Rand10-Using-Rand7" class="headerlink" title="leetcode 470: Implement Rand10() Using Rand7()"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/implement-rand10-using-rand7/">leetcode 470: Implement Rand10() Using Rand7()</a></h3><blockquote>
<p>Given the <strong>API</strong> rand7() that generates a uniform random integer in the range [1, 7], write a function rand10() that generates a uniform random integer in the range [1, 10]. You can only call the API rand7(), and you shouldn’t call any other API. Please do not use a language’s built-in random API.</p>
<p>Each test case will have one internal argument n, the number of times that your implemented function rand10() will be called while testing. Note that this is not an argument passed to rand10().</p>
<p>Follow up:<br>What is the expected value for the number of calls to rand7() function?<br>Could you minimize the number of calls to rand7()?</p>
<p>Example 1:<br>Input: n = 1<br>Output: [2]</p>
<p>Example 2:<br>Input: n = 2<br>Output: [2,8]</p>
<p>Example 3:<br>Input: n = 3<br>Output: [3,8,10]</p>
<p>Constraints:<br>1 &lt;= n &lt;= 105</p>
</blockquote>
<p><img src="/2020/12/03/random_algorithm/table.png" alt="Fig 1. 二维随机表格分布"><span class="image-caption">Fig 1. 二维随机表格分布</span></p>
<p>我们可以使用“拒绝采样”来求解这个题目。 注意rand10要求返回的数字在[1, 10]之间均匀分布。执行一次rand7()只能得到[1, 7]之间的均匀分布，我们可以执行两次rand7(), 将两次的执行结果看做表格的横纵坐标(row, col)，这时候表格中的每一个单元被选中的机会是相等的, 这样我们就得到了一个二维表格中的均匀分布。接下来， 我们将这个二维坐标转换为一维坐标，我们就得到了[1, 49]之间的均匀分布。我们的最终目标是得到[1, 10]之间的均匀分布，由于可以把[1, n * 10]之间的均匀分布通过取余预算转换为[1, 10]之间的均匀分布，所以这里我们取[1, 40]为有效值，当获取的值不在这个范围时候，我们重新采样。这个过程即拒绝采样。代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rand10</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="keyword">int</span> row = rand7();</span><br><span class="line">      <span class="keyword">const</span> <span class="keyword">int</span> col = rand7();</span><br><span class="line">      <span class="keyword">const</span> <span class="keyword">int</span> idx = (row - <span class="number">1</span>) * <span class="number">7</span> + col;</span><br><span class="line">      <span class="keyword">if</span> (idx &lt;= <span class="number">40</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> idx % <span class="number">10</span> + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> rand10();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="问题2：抽水采样"><a href="#问题2：抽水采样" class="headerlink" title="问题2：抽水采样"></a>问题2：抽水采样</h2><h3 id="leetcode-398-Random-Pick-Index"><a href="#leetcode-398-Random-Pick-Index" class="headerlink" title="leetcode 398: Random Pick Index"></a><a target="_blank" rel="noopener" href="https://leetcode.com/problems/random-pick-index/">leetcode 398: Random Pick Index</a></h3><blockquote>
<p>Given an array of integers with possible duplicates, randomly output the index of a given target number. You can assume that the given target number must exist in the array.</p>
<p>Note:<br>The array size can be very large. Solution that uses too much extra space will not pass the judge.</p>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] nums = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>&#125;;</span><br><span class="line">Solution solution = <span class="keyword">new</span> Solution(nums);</span><br><span class="line"></span><br><span class="line"><span class="comment">// pick(3) should return either index 2, 3, or 4 randomly.</span></span><br><span class="line"><span class="comment">// Each index should have equal probability of returning.</span></span><br><span class="line">solution.pick(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// pick(1) should return 0. Since in the array only nums[0] is equal to 1.</span></span><br><span class="line">solution.pick(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</blockquote>
<p>我们可以使用“<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B0%B4%E5%A1%98%E6%8A%BD%E6%A8%A3">抽水采样</a>”来求解这个题目。我们先给出代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Solution(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums): data(nums) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pick</span><span class="params">(<span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; data.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data[i] == target) &#123;</span><br><span class="line">                ++num;</span><br><span class="line">                <span class="keyword">const</span> <span class="keyword">int</span> r = rand() % num; <span class="comment">// value in [0, num - 1]</span></span><br><span class="line">                <span class="keyword">if</span> (r == <span class="number">0</span>) &#123;</span><br><span class="line">                    res = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>下面是一个具体分析：</p>
<ol>
<li>如果target只出现了1次，那么<code>rand() % num</code>等于0，这个index一定会被返回；</li>
<li>如果target出现了2次，第一个index被选中的概率是：<code>100% * 50% = 50%</code>；第二个index被选中的概率是<code>50%</code>，它们是被均匀采样的；</li>
<li>如果target出现了3次，那么它的3个index被返回的概率分别是：<ul>
<li><code>100% * (1 - 50%) * (1 - 33.33%) = 33.33%</code>，第一步被选中，第二步和第三步没有被换掉；</li>
<li><code>50% * (1 - 33.33%) = 33.33%</code>，第二步被选中，第三步没有被换掉；</li>
<li><code>33.33%</code>，第三步被选中；</li>
</ul>
</li>
</ol>
<p>以此类推，可以保证每个index被选中的概率是相等的。</p>
<h2 id="问题3-C-获取随机数"><a href="#问题3-C-获取随机数" class="headerlink" title="问题3: C++获取随机数"></a>问题3: C++获取随机数</h2><h3 id="rand"><a href="#rand" class="headerlink" title="rand()"></a><a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/numeric/random/rand">rand()</a></h3><p>Returns a pseudo-random integral value between 0 and RAND_MAX. And 0 and RAND_MAX included.</p>
<h3 id="uniform-int-distribution"><a href="#uniform-int-distribution" class="headerlink" title="uniform_int_distribution"></a><a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution">uniform_int_distribution</a></h3><p>Produces random integer values i, uniformly distributed on the closed interval [a, b].</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Will be used to obtain a seed for the random number engine.</span></span><br><span class="line">  <span class="built_in">std</span>::random_device rd;</span><br><span class="line">  <span class="comment">// Standard mersenne_twister_engine seeded with rd().</span></span><br><span class="line">  <span class="function"><span class="built_in">std</span>::mt19937 <span class="title">gen</span><span class="params">(rd())</span></span>;</span><br><span class="line">  <span class="function"><span class="built_in">std</span>::uniform_int_distribution&lt;&gt; <span class="title">distrib</span><span class="params">(<span class="number">1</span>, <span class="number">6</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; distrib(gen) &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,zh-TW,default">
    <link itemprop="mainEntityOfPage" href="https://www.leehengtong.com/2020/12/01/all_algo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="李亨通@leehengtong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咖啡时间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/01/all_algo/" class="post-title-link" itemprop="url">算法概述</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-01 10:18:34" itemprop="dateCreated datePublished" datetime="2020-12-01T10:18:34+08:00">2020-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-31 22:18:51" itemprop="dateModified" datetime="2021-01-31T22:18:51+08:00">2021-01-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近对“算法”有了新的理解，对于普通程序员来说，算法功底的好坏对于简洁而高质量的代码至关重要，因此决定从一些经典的ACM算法开始，扎实的学习一下这些算法和编程技巧，以期能有更好的将来。从网上搜索了一些资料，发现“@制糕神的算法工坊”整理的比较全面，这里借用他的一张图片，后续将从他的这个图片开始学习。</p>
<p><img src="/2020/12/01/all_algo/algo.jpeg" alt="图1 算法分类"><span class="image-caption">图1 算法分类</span></p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/332733219/answer/878129865">https://www.zhihu.com/question/332733219/answer/878129865</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="李亨通@leehengtong"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">李亨通@leehengtong</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.v2ex.com/" title="https:&#x2F;&#x2F;www.v2ex.com" rel="noopener" target="_blank">V2EX</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://medium.com/" title="https:&#x2F;&#x2F;medium.com" rel="noopener" target="_blank">Medium</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="/more" title="&#x2F;more">More</a>
        </li>
    </ul>
  </div>

      </div>

      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/1.js?i=5o12n4bg337&amp;s=220&amp;m=0&amp;v=false&amp;r=false&amp;b=000000&amp;n=false&amp;c=ff0000" async="async"></script>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李亨通@leehengtong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
